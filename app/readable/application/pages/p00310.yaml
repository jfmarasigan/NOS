---
# ====== Page: Gift Certificate ==============================
id: 310
identification: 
  name: Gift Certificate
  alias: GIFT-CERTIFICATE
  title: Gift Certificate

appearance: 
  page-mode: Normal
  page-template: Standard - No Footer
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: Do not focus cursor
  warn-on-unsaved-changes: true

javascript: 
  function-and-global-variable-declaration: |
    const p6KeyMap = {
        escape : (v) => {
            $("#exit").trigger("click");
        },
        s : (v) => {
            $("#s").trigger("click");
        },
        a : (v) => {
            $("#a").trigger("click");
        },
        u : (v) => {
            $("#u").trigger("click");
        },
        i : (v) => {
            $("#i").trigger("click");
        },
        p : (v) => {
            $("#p").trigger("click");
        },
        r : (v) => {
            $("#r").trigger("click");
        },
        v : (v) => {
            $("#v").trigger("click");
        },
        n : (v) => {
            $("#n").trigger("click");
        },
    }
    
    function mapP6Keys() {
        $(document).off('keydown.p6keyevents');
        $(document).on('keydown.p6keyevents', (ev) => {
            var key = ev.key?.toLowerCase();
                if (p6KeyMap[key]) {
                    ev.preventDefault();
                    p6KeyMap[key]();
                }
        });
    }
    
    function customEvent(event, data){
        mapP6Keys();
    }
  execute-when-page-loads: |
    mapP6Keys();
    setTitle("Gift Certificate Create/Update")
    
    // to pop search modal upon loading page
    $("#s").trigger("click");

css: 
  inline: |
    .t-Header .t-Header-branding {
        background-color: white !important;
        color: rgb(30, 58, 138) !important;
    }
    
    /* add margin to interactive grid table start */
    .t-Body-contentInner {
        padding-inline-end: var(--ut-body-content-padding-x, 2.5rem);
        padding-inline-start: var(--ut-body-content-padding-x, 2.5rem);
    }
    /* end */
    
    body {
        background-color: rgb(30, 58, 138);
    }
    
    #table > table, tr, th {
        font-size: 1.125rem;
    }
    
    #table > td {
        font-size: 1.125rem;
    }
    
    .btns {
        font-size: 1.125rem;
        color: white;
    }
    
    .text-left {
        text-align: left;
    }
    
    .margin-right {
        margin-right: 3rem;
    }
    
    .mt-3 {
        margin-top: 3rem;
    }
    
    .mt-2 {
        margin-top: 2rem;
    }
    
    .ms-1 {
        margin-left: .5rem;
    }
    
    .ml-2 {
        margin-left: 2rem;
    }
    
    .content-block {
        font-size: 1.25rem;
        display: flex;
        justify-content: space-between;
        font-weight: 700;
    }
    
    .hide {
        display: none;
    }
    
    .a-GV-header a, th.a-GV-header {
        background-color: #046BC8;
        color: white;
        pointer-events: none;
    }
    
    .a-IG,
    .a-GV-table .a-GV-cell, th.a-GV-header{
        border-color: 	black !important;
    }
    
    /* css for modal 311 start */
    
    .ui-dialog-titlebar {
        display: none !important;
    }
    
    .ui-dialog.pr-li {
       left: 80% !important;
    }
    
    .ui-dialog.inv-bby-w {
        left: 78% !important;
    }
    
    .ui-dialog.ship-his {
        left: 50% !important;
    }
    
    .ui-dialog.pur-order,
    .ui-dialog.inc-ship {
        left: 45% !important;
    }
    
    .ui-dialog.res {
        left: 32% !important;
    }
    
    .ui-widget-overlay.ui-front {
        background-color: transparent !important;
        opacity: 0 !important;
    }
    /* modal 311 end */
    
    /* modify position of inquire modal 314 sstart */
    .inquire-dialog {
        left: 53% !important;
    }
    /* modal 314 end */
    
    /* View height dependent table and buttons - START */
    .buttons-row {
        position: absolute;
        width: 95vw;
        bottom: 1rem;
    }
    
    #table .a-IG {
        height: calc(75vh + 2px) !important;
    } 
    
    #table .a-IG-contentContainer {
        height: 75vh !important;
    }
    
    #table .a-IG-gridView.a-GV {
        height: 75vh !important;
    }
    
    #table .a-GV-bdy {
        height: calc(75vh - 2.5625rem) !important;
    }
    
    /* View height dependent table and buttons - END */
    
    
    
    #table .a-GV-table {
        width: 100% !important;
    }
    
    #table .a-GV-table colgroup col:nth-child(2) {
        width: 20%;
    }
    
    #table .a-GV-table colgroup col:nth-child(3) {
        width: 15%;
    }
    
    .a-GV-header-sort {
        display: none;
    }

security: 
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

regions: 
- # ====== Region: Buttons =====================================
  id: 18625585793263501
  identification: 
    name: Buttons
    type: Static Content

  layout: 
    sequence: 110
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    row-css-classes: 
    - buttons-row
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: None
    render-components: Above Content

  advanced: 
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Gift Certificate List =======================
  id: 28430546326015709
  identification: 
    name: Gift Certificate List
    title: Gift Certificate List
    type: Interactive Grid

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      SELECT 
          ROWNUM AS "Primary Key",
          npt020.GIFT_CERTIFICATE_ID AS "GC_NO",
          npt020.DESCRIPTION_1 AS "DESCRIPTION_1",
          npt020.DESCRIPTION_2 AS "DESCRIPTION_2",
          npt020.AMOUNT AS "AMOUNT",
          npt020.BALANCE AS "BALANCE",
          npt020.ISSUE_DATE AS "ISSUE_DATE",
          npt020.EXPIRY_DATE AS "EXPIRY_DATE",
          npt020.RELEASE_DATE AS "RELEASE_DATE",
          npm014.GC_STATUS_NAME AS "STATUS"
      FROM
          NPT020 npt020
      JOIN 
          NPM014 npm014 ON npt020.GC_STATUS_ID = npm014.GC_STATUS_ID
      WHERE 
      
          -- check if SEARCH BY ISSUE YEAR has a value
          (:P310_ISSUE_YR IS NOT NULL OR :P310_ISSUE_YR != '') AND
              extract(year from npt020.ISSUE_DATE) = :P310_ISSUE_YR
          OR
      
          -- else, check if SEARCH BY GC NO has a value
             (:P310_ISSUE_YR IS NULL AND (:P310_GC_NO IS NOT NULL OR :P310_GC_NO != '')) AND
              npt020.GIFT_CERTIFICATE_ID = :P310_GC_NO;
    page-items-to-submit: 
    - P310_ISSUE_YR
    - P310_GC_NO

  layout: 
    sequence: 100
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Interactive Report
    template-options: 
    - '#DEFAULT#'
    - margin-top-md
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: table
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    id: 28430697845015710
    edit: 
      enabled: false

    performance: 
      lazy-loading: false

    appearance: 
      select-first-row: true
      fixed-row-height: true

    pagination: 
      type: Scroll
      show-total-count: true

    toolbar: 
      show: false

    enable-users-to: 
      save-public-report: false
      flashback: false
      define-chart-view: false
      download: false

    heading: 
      fixed-to: Region
      fixed-report-height: 300

    icon-view: 
      show: false

    detail-view: 
      show: false

    advanced: 
      initialization-javascript-function: |
        function( options ) {
            options.defaultModelOptions = {
                pageSize: 1000
            };
            options.defaultGridViewOptions = {
                pagination: {
                    scroll: true,
                    virtual: true,
                    loadMore: false
                },
                resizeColumns: false,
                reorderColumns: false,
                footer: false
            };
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            }
            return options;
        }

    saved-reports: 
    - # ====== Saved Report: Primary Report ========================
      id: 28523224422006196
      identification: 
        name: Primary Report
        alias: 285233

  columns: 
  - # ====== Column: GC_NO =======================================
    id: 28430705968015711
    identification: 
      column-name: GC_NO
      type: Text Field

    heading: 
      heading: GC No
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 20
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: GC_NO
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: Distinct Column

    export-/-printing: 
      include-in-export-/-print: false

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: DESCRIPTION_1 ===============================
    id: 28430822522015712
    identification: 
      column-name: DESCRIPTION_1
      type: Text Field

    heading: 
      heading: Description 1
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 30
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: DESCRIPTION_1
      data-type: VARCHAR2
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      performance-impacting-operators: 
      - Contains
      - Starts With
      - Case Insensitive
      - Regular Expression
      text-case: Mixed
      lov-type: Distinct Column
      exact-match: true

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: DESCRIPTION_2 ===============================
    id: 28430966962015713
    identification: 
      column-name: DESCRIPTION_2
      type: Text Field

    heading: 
      heading: Description 2
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 40
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: false

    source: 
      type: Database Column
      database-column: DESCRIPTION_2
      data-type: VARCHAR2
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      performance-impacting-operators: 
      - Contains
      - Starts With
      - Case Insensitive
      - Regular Expression
      text-case: Mixed
      lov-type: Distinct Column
      exact-match: true

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: AMOUNT ======================================
    id: 28431017756015714
    identification: 
      column-name: AMOUNT
      type: Number Field

    heading: 
      heading: Amount
      alignment: center

    settings: 
      number-alignment: Start
      virtual-keyboard: Decimal

    layout: 
      sequence: 50
      column-alignment: end
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: AMOUNT
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: None

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: BALANCE =====================================
    id: 28431180050015715
    identification: 
      column-name: BALANCE
      type: Text Field

    heading: 
      heading: Balance
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 60
      column-alignment: end
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: BALANCE
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: Distinct Column

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: ISSUE_DATE ==================================
    id: 28431274284015716
    identification: 
      column-name: ISSUE_DATE
      type: Text Field

    heading: 
      heading: Issue Date
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 70
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: ISSUE_DATE
      data-type: DATE
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: Distinct Column
      date-ranges: All

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: EXPIRY_DATE =================================
    id: 28431358147015717
    identification: 
      column-name: EXPIRY_DATE
      type: Date Picker

    heading: 
      heading: Expiry Date
      alignment: center

    settings: 
      show-time: false
      display-as: Popup
      minimum-date: None
      maximum-date: None
      multiple-months: No
      use-defaults: true

    layout: 
      sequence: 80
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: EXPIRY_DATE
      data-type: DATE
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: Distinct Column
      date-ranges: All

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: RELEASE_DATE ================================
    id: 28431471846015718
    identification: 
      column-name: RELEASE_DATE
      type: Text Field

    heading: 
      heading: Release Date
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 90
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: false

    source: 
      type: Database Column
      database-column: RELEASE_DATE
      data-type: DATE
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      lov-type: Distinct Column
      date-ranges: All

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: STATUS ======================================
    id: 28431571210015719
    identification: 
      column-name: STATUS
      type: Text Field

    heading: 
      heading: Status
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 100
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: STATUS
      data-type: VARCHAR2
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: true
      performance-impacting-operators: 
      - Contains
      - Starts With
      - Case Insensitive
      - Regular Expression
      text-case: Mixed
      lov-type: Distinct Column
      exact-match: true

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: true
      control-break/aggregate: true
      hide: true

  - # ====== Column: Primary Key =================================
    id: 30147016525825001
    identification: 
      column-name: Primary Key
      type: Hidden

    settings: 
      value-protected: true

    layout: 
      sequence: 10

    accessibility: 
      value-identifies-row: false

    source: 
      type: Database Column
      database-column: Primary Key
      data-type: NUMBER
      query-only: false
      primary-key: true

    default: 
      duplicate-copies-existing-value: true

    session-state: 
      data-type: VARCHAR2

    export-/-printing: 
      include-in-export-/-print: false

    enable-users-to: 
      sort: false

page-items: 
- # ====== Page Item: P310_ISSUE_YR ============================
  id: 28431903679015723
  identification: 
    name: P310_ISSUE_YR
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 10
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_GC_NO ===============================
  id: 28432058433015724
  identification: 
    name: P310_GC_NO
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 20
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_SELECTED_GC_NO ======================
  id: 28434416666015748
  identification: 
    name: P310_SELECTED_GC_NO
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 30
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_PREPARED_URL ========================
  id: 30147158263825002
  identification: 
    name: P310_PREPARED_URL
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 60
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_GET_SUCCESS_MSG =====================
  id: 30917104078029538
  identification: 
    name: P310_GET_SUCCESS_MSG
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 40
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_SELECTED_GC_STATUS ==================
  id: 34718911167647749
  identification: 
    name: P310_SELECTED_GC_STATUS
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 70
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_IS_DONATION =========================
  id: 37009355742700430
  identification: 
    name: P310_IS_DONATION
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 80
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P310_PRINT_ID ============================
  id: 37009423656700431
  identification: 
    name: P310_PRINT_ID
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 90
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: Search ======================================
  id: 18625619398263502
  identification: 
    button-name: Search
    label: <u>S </u>- Search

  layout: 
    sequence: 10
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ml-2
    - mt-3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:311:&SESSION.::&DEBUG.:::'
      page: 311 # Gift Certificate Search

    warn-on-unsaved-changes: Do Not Check

  advanced: 
    static-id: s

- # ====== Button: Add =========================================
  id: 18625716115263503
  identification: 
    button-name: Add
    label: <u>A </u>- Add

  layout: 
    sequence: 30
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:312:&SESSION.::&DEBUG.:::'
      page: 312 # Add Gift Certificate

    warn-on-unsaved-changes: Do Not Check

  advanced: 
    static-id: a

- # ====== Button: Update ======================================
  id: 18625845698263504
  identification: 
    button-name: Update
    label: <u>U </u>- Update

  layout: 
    sequence: 50
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: u

  server-side-condition: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: "has_access(:APP_USER, 2, 7) = 'Y'"

- # ====== Button: Inquire =====================================
  id: 18625910719263505
  identification: 
    button-name: Inquire
    label: <u>I </u>- Inquire

  layout: 
    sequence: 70
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: i

- # ====== Button: Print =======================================
  id: 18626077494263506
  identification: 
    button-name: Print
    label: <u>P </u>- Print

  layout: 
    sequence: 80
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: p

- # ====== Button: Release =====================================
  id: 26313559983216515
  identification: 
    button-name: Release
    label: <u>R </u>- Release

  layout: 
    sequence: 90
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ml-2
    - mt-2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: r

- # ====== Button: Void ========================================
  id: 26313678375216516
  identification: 
    button-name: Void
    label: <u>V </u>- Void

  layout: 
    sequence: 100
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: v

- # ====== Button: Void_And_Print_new ==========================
  id: 26313740483216517
  identification: 
    button-name: Void_And_Print_new
    label: <u>N </u>- Void & Print New

  layout: 
    sequence: 110
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: n

- # ====== Button: Back ========================================
  id: 28430266277015706
  identification: 
    button-name: Back
    label: Back

  layout: 
    sequence: 120
    region: Buttons # 18625585793263501
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    column-css-classes: 
    - ms-1
    - mt-2
    - hide
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:304:&SESSION.::&DEBUG.:::'
      page: 304 # Gift Certificate Submenu

    warn-on-unsaved-changes: Do Not Check

  advanced: 
    static-id: exit

dynamic-actions: 
- # ====== Dynamic Action: Get Search Value ====================
  id: 28431680511015720
  identification: 
    name: Get Search Value

  execution: 
    sequence: 10
    event-scope: Static
    type: Immediate

  when: 
    event: Dialog Closed
    selection-type: Button
    button: Search # 18625619398263502

  actions: 
  - # ====== Action: Get Issue Yr Search =========================
    id: 28431878970015722
    identification: 
      name: Get Issue Yr Search
      action: Set Value

    settings: 
      set-type: Dialog Return Item
      return-item: P311_SEARCH_BY_ISSUE_YR
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_ISSUE_YR

    execution: 
      sequence: 20
      event: Get Search Value # 28431680511015720
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Get Gc No Search ============================
    id: 28432155509015725
    identification: 
      name: Get Gc No Search
      action: Set Value

    settings: 
      set-type: Dialog Return Item
      return-item: P311_GC_NO
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_GC_NO

    execution: 
      sequence: 30
      event: Get Search Value # 28431680511015720
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Refresh =====================================
    id: 28432587909015729
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Gift Certificate List # 28430546326015709

    execution: 
      sequence: 50
      event: Get Search Value # 28431680511015720
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: To select 1st cell of the table =============
    id: 28434632925015750
    identification: 
      name: To select 1st cell of the table
      action: Execute JavaScript Code

    settings: 
      code: |
        setTimeout(() => {
          $( document ).ready(function() {
            $(".a-GV-cell").first().trigger("click");
         });
        
        
        }, "1000");

    affected-elements: 
      selection-type: Region
      region: Gift Certificate List # 28430546326015709

    execution: 
      sequence: 60
      event: Get Search Value # 28431680511015720
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Selection Change ====================
  id: 28434269922015746
  identification: 
    name: Selection Change

  execution: 
    sequence: 20
    event-scope: Static
    type: Immediate

  when: 
    event: NATIVE_IG|REGION TYPE|interactivegridselectionchange
    selection-type: Region
    region: Gift Certificate List # 28430546326015709

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 28434386620015747
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        if (this.data.selectedRecords.length > 0) {
            let itemNoSelected = this.data.selectedRecords[0][1];
            apex.item("P310_SELECTED_GC_NO").setValue(itemNoSelected);
        }

    execution: 
      sequence: 10
      event: Selection Change # 28434269922015746
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Update selected GC ==================
  id: 30147284634825003
  identification: 
    name: Update selected GC

  execution: 
    sequence: 30
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Update # 18625845698263504

  client-side-condition: 
    type: Item is not null
    item: P310_SELECTED_GC_NO

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 30147413321825005
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        -- redirect and pass value to url (which is the update page)
        BEGIN
            :P310_PREPARED_URL := apex_page.get_url(
               p_page   => 317,
               p_items  => 'P317_GC_NO',
               p_values => :P310_SELECTED_GC_NO
             );
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      items-to-return: 
      - P310_PREPARED_URL
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Update selected GC # 30147284634825003
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Execute JavaScript Code =====================
    id: 30147552575825006
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        // set url to redirect to update
        let url = $v("P310_PREPARED_URL");
        apex.navigation.redirect(url);

    execution: 
      sequence: 30
      event: Update selected GC # 30147284634825003
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item is not null
      item: P310_PREPARED_URL

- # ====== Dynamic Action: Open release popup ==================
  id: 30915812671029525
  identification: 
    name: Open release popup

  execution: 
    sequence: 40
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Release # 26313559983216515

  client-side-condition: 
    type: Item is not null
    item: P310_SELECTED_GC_NO

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 30916442063029531
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        -- redirect and pass value to url (which is the release dialog modal)
        BEGIN
            :P310_PREPARED_URL := apex_page.get_url(
               p_page   => 315,
               p_items  => 'P315_GET_SELECTED_GC_NO,P315_GET_SEARCHED_YEAR,P315_GET_SEARCHED_GC_NO',
               p_values => :P310_SELECTED_GC_NO || ',' || :P310_ISSUE_YR || ',' || :P310_GC_NO
             );
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      items-to-return: 
      - P310_PREPARED_URL
      suppress-change-event: false

    execution: 
      sequence: 40
      event: Open release popup # 30915812671029525
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P310_SELECTED_GC_NO

  - # ====== Action: Execute JavaScript Code =====================
    id: 30916590671029532
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        // set url to redirect to release dialog modal
        let url = $v("P310_PREPARED_URL");
        apex.navigation.redirect(url);

    execution: 
      sequence: 50
      event: Open release popup # 30915812671029525
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item is not null
      item: P310_PREPARED_URL

- # ====== Dynamic Action: Release GC Close Dialog =============
  id: 30917460221029541
  identification: 
    name: Release GC Close Dialog

  execution: 
    sequence: 60
    event-scope: Static
    type: Immediate

  when: 
    event: Dialog Closed
    selection-type: JavaScript Expression
    javascript-expression: window

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 30917598533029542
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        apex.server.process('GET_SUCCESS_MSG', {}, {
                success: function(data) {
                    if (data.success_msg) {
        
                        apex.message.showPageSuccess(data.success_msg);
        
                        setTimeout(function() {
                            $(".apex-page-success").fadeOut(400);
                        }, 3000);
        
                    }
                }
            });
        
        // refreshes the table to update the release date
        // apex.region("table").refresh();

    execution: 
      sequence: 10
      event: Release GC Close Dialog # 30917460221029541
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Refresh table to see update =================
    id: 30917978674029546
    identification: 
      name: Refresh table to see update
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Gift Certificate List # 28430546326015709

    execution: 
      sequence: 20
      event: Release GC Close Dialog # 30917460221029541
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Open inquire popup ==================
  id: 31990303068279522
  identification: 
    name: Open inquire popup

  execution: 
    sequence: 50
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Inquire # 18625910719263505

  client-side-condition: 
    type: Item is not null
    item: P310_SELECTED_GC_NO

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 31990494386279523
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        BEGIN
            :P310_PREPARED_URL := apex_page.get_url(
               p_page   => 314,
               p_items  => 'P314_GET_SELECTED_GC_NO',
               p_values => :P310_SELECTED_GC_NO
             );
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      items-to-return: 
      - P310_PREPARED_URL
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Open inquire popup # 31990303068279522
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P310_SELECTED_GC_NO

  - # ====== Action: Execute JavaScript Code =====================
    id: 31990507198279524
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        // set url to redirect to release dialog modal
        let url = $v("P310_PREPARED_URL");
        apex.navigation.redirect(url);

    execution: 
      sequence: 30
      event: Open inquire popup # 31990303068279522
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item is not null
      item: P310_PREPARED_URL

- # ====== Dynamic Action: Void selected gc ====================
  id: 34715009781647710
  identification: 
    name: Void selected gc

  execution: 
    sequence: 70
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Void # 26313678375216516

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 34715131873647711
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
        BEGIN
            UPDATE NPT020
                SET BALANCE = 0,
                    AMOUNT = 0,
                    GC_STATUS_ID = 5,
                    USER_UPDATE = :app_user, 
                    DATE_UPDATED = SYSDATE
                WHERE GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO;
        END;
        
      items-to-submit: 
      - P310_SELECTED_GC_NO
      items-to-return: 
      - P310_PREPARED_URL
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Void selected gc # 34715009781647710
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Execute JavaScript Code =====================
    id: 34715238603647712
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: apex.message.showPageSuccess( "Successfully voided gift certificate" );

    execution: 
      sequence: 30
      event: Void selected gc # 34715009781647710
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Refresh =====================================
    id: 34715350839647713
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Gift Certificate List # 28430546326015709

    execution: 
      sequence: 70
      event: Void selected gc # 34715009781647710
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Execute JavaScript Code =====================
    id: 34715517143647715
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        setTimeout(function() {
            $('.t-Button--closeAlert').click();
        }, 3000);

    execution: 
      sequence: 50
      event: Void selected gc # 34715009781647710
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

- # ====== Dynamic Action: Open copies popup ===================
  id: 34717047883647730
  identification: 
    name: Open copies popup

  execution: 
    sequence: 80
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Print # 18626077494263506

  client-side-condition: 
    type: Item is not null
    item: P310_SELECTED_GC_NO

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 34717239692647732
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        BEGIN
            :P310_PREPARED_URL := apex_page.get_url(
               p_page   => 313,
               p_items  => 'P313_SELECTED_GC_NO',
               p_values => :P310_SELECTED_GC_NO
             );
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      items-to-return: 
      - P310_PREPARED_URL
      suppress-change-event: false

    execution: 
      sequence: 30
      event: Open copies popup # 34717047883647730
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Execute JavaScript Code =====================
    id: 34717329741647733
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let url = $v("P310_PREPARED_URL");
        apex.navigation.redirect(url);

    execution: 
      sequence: 40
      event: Open copies popup # 34717047883647730
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Set Value ===================================
    id: 34718890448647748
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
        
        l_return_value  VARCHAR(1) := NULL;
        
        BEGIN
        
            IF LENGTH(:P310_SELECTED_GC_NO) > 0 THEN
            
                SELECT GC_STATUS_ID INTO l_return_value
                FROM NPT020
                WHERE GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO;
        
            END IF;
        
            RETURN l_return_value;
        
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_SELECTED_GC_STATUS

    execution: 
      sequence: 20
      event: Open copies popup # 34717047883647730
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Void and print selected gc ==========
  id: 37008869593700425
  identification: 
    name: Void and print selected gc

  execution: 
    sequence: 100
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Void_And_Print_new # 26313740483216517

  client-side-condition: 
    type: Item is not null
    item: P310_SELECTED_GC_NO

  actions: 
  - # ====== Action: Get status ==================================
    id: 37008579984700422
    identification: 
      name: Get status
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
        
        l_return_value  VARCHAR(1) := NULL;
        
        BEGIN
        
            IF LENGTH(:P310_SELECTED_GC_NO) > 0 THEN
            
                SELECT GC_STATUS_ID INTO l_return_value
                FROM NPT020
                WHERE GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO;
        
            END IF;
        
            RETURN l_return_value;
        
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_SELECTED_GC_STATUS

    execution: 
      sequence: 20
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Set selected gc to void =====================
    id: 37009187316700428
    identification: 
      name: Set selected gc to void
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
        BEGIN
            sys.dbms_session.sleep(3);
            UPDATE NPT020
                SET BALANCE = 0,
                    AMOUNT = 0,
                    GC_STATUS_ID = 5,
                    USER_UPDATE = :app_user, 
                    DATE_UPDATED = SYSDATE
                WHERE GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO;
        END;
        
      items-to-submit: 
      - P310_SELECTED_GC_NO

    execution: 
      sequence: 90
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Execute JavaScript Code =====================
    id: 37009296567700429
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        if ($v("P310_IS_DONATION") === "Y") {
            generateReport("GC_DONATION", "pdf", { 
                fileName: "Gift_Certificate_Print_Id_" + $v("P310_PRINT_ID") + ".pdf",
                mode : "print",
                parameters : {
                    P_SELECTED_PRINT_ID : $v("P310_PRINT_ID")
                },
                spinnerEnabled : false
            });
        } else {
            generateReport("GC_NORMAL", "pdf", { 
                fileName: "Gift_Certificate_Print_Id_" + $v("P310_PRINT_ID") + ".pdf",
                mode : "print",
                parameters : {
                    P_SELECTED_PRINT_ID : $v("P310_PRINT_ID")
                },
                spinnerEnabled : false
            });
        }

    execution: 
      sequence: 80
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Set donation type ===========================
    id: 37009555516700432
    identification: 
      name: Set donation type
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
        
        l_return_value  VARCHAR(1) := NULL;
        
        BEGIN
        
            IF LENGTH(:P310_SELECTED_GC_NO) > 0 THEN
            
                SELECT DONATION INTO l_return_value
                FROM NPM013 npm013
                WHERE (SELECT npt020.GC_TYPE_ID
                       FROM NPT020 npt020
                       WHERE npt020.GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO) = npm013.GC_TYPE_ID;
        
            END IF;
        
            RETURN l_return_value;
        
        END;
      items-to-submit: 
      - P310_SELECTED_GC_NO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_IS_DONATION

    execution: 
      sequence: 50
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Set new PRINT_ID ============================
    id: 37009605551700433
    identification: 
      name: Set new PRINT_ID
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
        
        l_return_value  NUMBER := NULL;
        
        BEGIN
        
            SELECT (NVL(MAX(npt020.PRINT_ID), 0) + 1) INTO l_return_value
            FROM NPT020 npt020;
        
            -- :P310_PRINT_ID := l_return_value;
        
            RETURN l_return_value;
        
        END;
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P310_PRINT_ID

    execution: 
      sequence: 60
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Execute JavaScript Code =====================
    id: 37009788882700434
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: apex.message.showPageSuccess( "Successfully voided gift certificate" );

    execution: 
      sequence: 100
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Execute JavaScript Code =====================
    id: 37009860101700435
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        setTimeout(function() {
            $('.t-Button--closeAlert').click();
        }, 3000);

    execution: 
      sequence: 110
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Update selected gc print id =================
    id: 37009925833700436
    identification: 
      name: Update selected gc print id
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
        BEGIN
            UPDATE NPT020
                SET PRINT_ID = :P310_PRINT_ID,
                    USER_UPDATE = :app_user,
                    DATE_UPDATED = SYSDATE,
                    PRINT_DATE = SYSDATE
                WHERE GIFT_CERTIFICATE_ID = :P310_SELECTED_GC_NO;
        END;
        
      items-to-submit: 
      - P310_SELECTED_GC_NO
      - P310_PRINT_ID

    execution: 
      sequence: 70
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: JavaScript expression
      javascript-expression: $("#P310_SELECTED_GC_STATUS").val() !== "4" && $("#P310_SELECTED_GC_STATUS").val() !== "5"

  - # ====== Action: Refresh =====================================
    id: 37010067940700437
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Gift Certificate List # 28430546326015709

    execution: 
      sequence: 120
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item > Value
      item: P310_SELECTED_GC_NO
      value: 0

  - # ====== Action: Trigger spinner =============================
    id: 38243280129771113
    identification: 
      name: Trigger spinner
      action: Execute JavaScript Code

    settings: 
      code: apex.widget.waitPopup()

    execution: 
      sequence: 30
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Remove spinner ==============================
    id: 38243381699771114
    identification: 
      name: Remove spinner
      action: Execute JavaScript Code

    settings: 
      code: |
        $("#apex_wait_popup").remove();
        $("#apex_wait_overlay").remove();
        $(".u-Processing").remove();

    execution: 
      sequence: 130
      event: Void and print selected gc # 37008869593700425
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: If Add Success ======================
  id: 38244199289771122
  identification: 
    name: If Add Success

  execution: 
    sequence: 110
    event-scope: Static

  when: 
    event: Page Load

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 38244293421771123
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        $(document).ready(function() {
        
            apex.server.process('GET_SUCCESS_MSG', {}, {
                success: function(data) {
                    if (data.success_msg) {
        
                        apex.message.showPageSuccess(data.success_msg);
        
                        setTimeout(function() {
                            $(".apex-page-success").fadeOut(400);
                        }, 3000);
        
                    }
                }
            });
        });
        

    execution: 
      sequence: 10
      event: If Add Success # 38244199289771122
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Show success ========================
  id: 38244446839771125
  identification: 
    name: Show success

  execution: 
    sequence: 120
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P310_GET_SUCCESS_MSG_1

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 38244570035771126
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: apex.message.showPageSuccess( "Successfully released gift certificate" );

    execution: 
      sequence: 10
      event: Show success # 38244446839771125
      fire-when-event-result-is: True
      fire-on-initialization: false

    client-side-condition: 
      type: Item = Value
      item: P310_GET_SUCCESS_MSG_1
      value: true

computations: 
- # ====== Computation: P310_GC_NO =============================
  id: 28432308116015727
  identification: 
    item-name: P310_GC_NO

  execution: 
    sequence: 10
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: NULL

  comments: 
    comments: this is used to clear the last assigned value

- # ====== Computation: P310_ISSUE_YR ==========================
  id: 28432402264015728
  identification: 
    item-name: P310_ISSUE_YR

  execution: 
    sequence: 20
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: NULL

  comments: 
    comments: this is used to clear the last assigned value

- # ====== Computation: P310_SELECTED_GC_NO ====================
  id: 30477801856245233
  identification: 
    item-name: P310_SELECTED_GC_NO

  execution: 
    sequence: 30
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

  comments: 
    comments: this is used to clear the last assigned value

- # ====== Computation: P310_PREPARED_URL ======================
  id: 30477932897245234
  identification: 
    item-name: P310_PREPARED_URL

  execution: 
    sequence: 40
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

  comments: 
    comments: this is used to clear the last assigned value

- # ====== Computation: P310_GET_SUCCESS_MSG ===================
  id: 30917699532029543
  identification: 
    item-name: P310_GET_SUCCESS_MSG

  execution: 
    sequence: 50
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

- # ====== Computation: P310_SELECTED_GC_STATUS ================
  id: 37010115313700438
  identification: 
    item-name: P310_SELECTED_GC_STATUS

  execution: 
    sequence: 60
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

- # ====== Computation: P310_IS_DONATION =======================
  id: 37010283427700439
  identification: 
    item-name: P310_IS_DONATION

  execution: 
    sequence: 70
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

- # ====== Computation: P310_PRINT_ID ==========================
  id: 37010355357700440
  identification: 
    item-name: P310_PRINT_ID

  execution: 
    sequence: 80
    point: Before Regions

  computation: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: Null

processes: 
- # ====== Process: GET_SUCCESS_MSG ============================
  id: 30917215723029539
  identification: 
    name: GET_SUCCESS_MSG
    type: Execute Code
    execution-chain: None

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      DECLARE
         l_msg VARCHAR2(200);
      BEGIN
         -- Get the value of the SUCCESS_MSG application item
         l_msg := apex_util.get_session_state('SUCCESS_MSG');
         
         -- Return it as a JSON object
         apex_json.open_object;
         apex_json.write('success_msg', l_msg);
         apex_json.close_object;
      
         -- Clear the SUCCESS_MSG after displaying it
         apex_util.set_session_state('SUCCESS_MSG', NULL);
      END;
      

  execution: 
    sequence: 20
    point: Ajax Callback
    run-process: Once Per Page Visit (default)

- # ====== Process: CLEAR_SUCCESS_MSG ==========================
  id: 30917312403029540
  identification: 
    name: CLEAR_SUCCESS_MSG
    type: Execute Code
    execution-chain: None

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      BEGIN
      	apex_util.set_session_state('SUCCESS_MSG', null);
      END;

  execution: 
    sequence: 10
    point: Ajax Callback
    run-process: Once Per Page Visit (default)

