---
# ====== Page: Payments Map (Customer) =======================
id: 150
identification: 
  name: Payments Map (Customer)
  alias: PAYMENTS-MAP-CUSTOMER
  title: Payments Map (Customer)

appearance: 
  page-mode: Normal
  page-template: Standard - No Footer
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: Do not focus cursor
  warn-on-unsaved-changes: false

javascript: 
  file-urls: 
  - '#APP_FILES#js/cmn#MIN#.js'
  function-and-global-variable-declaration: |
    const p150KeyMapMenu = {
        escape : (v) => {
            $("#esc").trigger("click");
        },
        c : (v) => {
            $("#c").trigger("click");
        },
        d : (v) => {
            $("#d").trigger("click");
        },
        p : (v) => {
            $("#print").trigger("click");
        },
        n : (v) => {
            $("#navigate").trigger("click");
        },
        h : (v) => {
            $("#export").trigger("click");
        },
        enter : (v) => {
            $("#refresh").trigger("click");
        }
    }
    
    
    function mapP150KeysMenu() {
        $(document).off('keydown.p150keyevents');
        $(document).on('keydown.p150keyevents', (ev) => {
            var key = ev.key?.toLowerCase();
            if (p150KeyMapMenu[key]) {
                ev.preventDefault();
                p150KeyMapMenu[key]();
            }
        });
    }
    
    
    function handleTabNavigation() {
    
        $("#P150_DBA, #P150_DATE_FROM, #P150_DATE_TO").attr("tabindex", 0);
        $(":focusable").not("#P150_DBA, #P150_DATE_FROM, #P150_DATE_TO").attr("tabindex", -1);
        
        const firstTableCells = $("#payment_ig_grid_vc .a-GV-cell");
        const secondTableCells = $("#invoice-list_ig_grid_vc .a-GV-cell");
    
        firstTableCells.on("keydown", function (event) {
        if (event.key === "tab" && !event.shiftKey) { 
            event.preventDefault(); 
            secondTableCells.first().trigger("click").focus(); 
        }
    });
    
        secondTableCells.on("keydown", function (event) {
        if (event.key === "tab" && event.shiftKey) { 
            event.preventDefault(); 
            firstTableCells.last().trigger("click").focus(); 
        }
    });
    
    }
    
    
    function isValidDate(dateString) {
        const dateFormatRegex = /^(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4}$/;
        if (!dateFormatRegex.test(dateString)) {
            return false;
        }
    
        const [month, day, year] = dateString.split("/").map(Number);
        const date = new Date(year, month - 1, day);
    
        return date.getFullYear() === year &&
               date.getMonth() === month - 1 &&
               date.getDate() === day;
    }
  execute-when-page-loads: |
    mapP150KeysMenu();
    
    setTitle("Payments Map");
    $x('P150_DBA').focus();
    
    handleTabNavigation();
    

css: 
  inline: |
    .btns {
        font-size: 1.125rem;
        color: white;
    }
    
    .buttons-row {
        position: absolute;
        width: 98vw;
        bottom: 1.75rem;
    }
    
    #dba-and-date label, #summary label, #summary span {
        font-size: 1.125rem;
        color: white;
    }
    #dba-and-date input {
        font-size: 1.125rem;
    }
    
    .t-Form-labelContainer:has(> #P150_DBA_LABEL),
    .t-Form-labelContainer:has(> #P150_DATE_FROM_LABEL),
    .t-Form-labelContainer:has(> #P150_TOTAL_PAYMENT_LABEL),
    .t-Form-labelContainer:has(> #P150_TOTAL_CREDIT_MEMO_LABEL) {
        text-align: start;
    }
    .t-Form-labelContainer:has(> #P150_DATE_TO_LABEL) {
        text-align: center;
    }
    
    /*
    #invoice-list .a-IG {
        height: calc(50vh + 2px) !important;
    } 
    
    #invoice-list .a-IG-contentContainer,
    #invoice-list .a-IG-gridView.a-GV {
        height: 50vh !important;
    }
    
    #invoice-list .a-GV-bdy {
        height: calc(50vh - 2.5625rem) !important;
    }
    */
    
    
    #payment .a-IG, #invoice-list .a-IG {
        height: calc(55vh + 2px) !important;
    } 
    
    #payment .a-IG-contentContainer,
    #payment .a-IG-gridView.a-GV,
    #invoice-list .a-IG-contentContainer,
    #invoice-list .a-IG-gridView.a-GV {
        height: 55vh !important;
    }
    
    #payment .a-GV-bdy,
    #invoice-list .a-GV-bdy{
        height: calc(55vh - 2.5625rem) !important;
    }
    
    
    
    .t-Header .t-Header-branding {
        background-color: white !important;
        color: rgb(30, 58, 138) !important;
    }
    
    
    body {
        background-color: rgb(30, 58, 138);
    }
    
    .text-left {
        text-align: left;
    }
    
    #payment table,
    #payment tr,
    #payment td,
    #payment th,
    #invoice-list table,
    #invoice-list tr,
    #invoice-list td,
    #invoice-list th {
        font-size: 1.125rem;
    }
    
    #payment_ig, 
    #invoice-list_ig {
        border: 0.0625rem solid black;
    }
    
    .a-GV-table .a-GV-cell, th.a-GV-header {
        border-color: black;
    }
    
    .a-GV-header a, th.a-GV-header {
        background-color: #046BC8;
        color: white;
    }
    
    .ui-dialog .ui-dialog-titlebar {
        background-color: #046BC8;
        color: white;
    }
    
    
    .a-GV-hdr .a-GV-table {
        width: 100% !important;
    }
    
     /* Hide scrollbar for Chrome, Safari and Opera */
    html::-webkit-scrollbar {
      display: none;
    }
    
    
    html {
      -ms-overflow-style: none;
      scrollbar-width: none; 
    } 
    
    .a-GV-w-scroll::-webkit-scrollbar {
      display: none;
    }
     
    .a-GV-w-scroll {
      -ms-overflow-style: none;  
      scrollbar-width: none; 
    }
    
    .text-white {
        color: white;
    }
    
    .label-font-size {
        font-size: 1.125rem;
    }
    
    .hiddenbtn {
        display: none;
    }
    
    .t-Form-error {
        color: #FFD700;
    }
    
    #P150_DATE_FROM_error_placeholder, P150_DATE_TO_error_placeholder {
        display: inline !important;
    }

security: 
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

regions: 
- # ====== Region: Summary =====================================
  id: 19847714298977041
  identification: 
    name: Summary
    type: Static Content

  layout: 
    sequence: 60
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: 8
    new-column: true
    column-span: 4

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--noUI
    - t-Region--scrollBody
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: summary
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Customer Payment ============================
  id: 41787619939876147
  identification: 
    name: Customer Payment
    type: Interactive Grid

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      SELECT 
          NPT005.date_created AS "Date Paid",
          NPT005.cashcheck AS "Cash/Check",
          NPT005.amount AS "Paid Amount",
          NPT005.OR_NO AS "OR No.",
          NPM015.collection_type_name AS "Type",
          NPT005.collection_id AS "Collection ID",
          NPT001.customer_id AS "Customer ID"
      FROM
          NPT005
      JOIN 
          NPM015 ON NPT005.collection_type_id = NPM015.collection_type_id
      JOIN 
          NPT038 ON NPT005.collection_id = NPT038.collection_id
      JOIN
          NPT001 ON NPT038.invoice_id = NPT001.invoice_id
      JOIN 
          NPT009 ON NPT001.customer_id = NPT009.customer_id
      WHERE
          UPPER(NPT009.DBA) = UPPER(:P150_DBA)
      AND
          TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO;
      
    page-items-to-submit: 
    - P150_DBA
    - P150_DATE_FROM
    - P150_DATE_TO

  layout: 
    sequence: 90
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: 2
    new-column: true
    column-span: 5

  appearance: 
    template: Interactive Report
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: payment
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    id: 41787738197876148
    edit: 
      enabled: false

    performance: 
      lazy-loading: false

    appearance: 
      select-first-row: true
      fixed-row-height: true

    pagination: 
      type: Scroll
      show-total-count: false

    toolbar: 
      show: false

    enable-users-to: 
      save-public-report: false
      flashback: false
      define-chart-view: false
      download: false

    heading: 
      fixed-to: Region
      fixed-report-height: 400

    icon-view: 
      show: false

    detail-view: 
      show: false

    advanced: 
      initialization-javascript-function: |
        function( options ) {
            options.defaultModelOptions = {
                pageSize: 1000
            };
            options.defaultGridViewOptions = {
                pagination: {
                    scroll: true,
                    virtual: true,
                    loadMore: false
                },
                resizeColumns: false,
                reorderColumns: false,
                footer: false
            };
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            }
            return options;
        }

    saved-reports: 
    - # ====== Saved Report: Primary Report ========================
      id: 42960748934723179
      identification: 
        name: Primary Report
        alias: 429608

  columns: 
  - # ====== Column: Date Paid ===================================
    id: 41787887924876149
    identification: 
      column-name: Date Paid
      type: Date Picker

    heading: 
      heading: Date Paid
      alignment: center

    settings: 
      show-time: false
      display-as: Popup
      minimum-date: None
      maximum-date: None
      multiple-months: No
      use-defaults: true

    layout: 
      sequence: 30
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: Date Paid
      data-type: DATE
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: Cash/Check ==================================
    id: 41787998166876150
    identification: 
      column-name: Cash/Check
      type: Text Field

    heading: 
      heading: Cash&#x2F;check
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 40
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true
      maximum-length: 52

    source: 
      type: Database Column
      database-column: Cash/Check
      data-type: VARCHAR2
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: Paid Amount =================================
    id: 42954249005722501
    identification: 
      column-name: Paid Amount
      type: Number Field

    heading: 
      heading: Paid Amount
      alignment: center

    settings: 
      number-alignment: Start
      virtual-keyboard: Decimal

    layout: 
      sequence: 50
      column-alignment: end
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: Paid Amount
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: OR No. ======================================
    id: 42954357661722502
    identification: 
      column-name: OR No.
      type: Number Field

    heading: 
      heading: Or No.
      alignment: center

    settings: 
      number-alignment: Start
      virtual-keyboard: Decimal

    layout: 
      sequence: 60
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: false

    source: 
      type: Database Column
      database-column: OR No.
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: Type ========================================
    id: 42954488806722503
    identification: 
      column-name: Type
      type: Text Field

    heading: 
      heading: Type
      alignment: center

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 70
      column-alignment: center
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true
      maximum-length: 80

    source: 
      type: Database Column
      database-column: Type
      data-type: VARCHAR2
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: Customer ID =================================
    id: 42955821343722517
    identification: 
      column-name: Customer ID
      type: Hidden

    settings: 
      value-protected: true

    layout: 
      sequence: 80

    accessibility: 
      value-identifies-row: false

    source: 
      type: Database Column
      database-column: Customer ID
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    session-state: 
      data-type: VARCHAR2

    export-/-printing: 
      include-in-export-/-print: false

    enable-users-to: 
      sort: false

  - # ====== Column: Collection ID ===============================
    id: 42956634971722525
    identification: 
      column-name: Collection ID
      type: Hidden

    settings: 
      value-protected: true

    layout: 
      sequence: 90

    accessibility: 
      value-identifies-row: false

    source: 
      type: Database Column
      database-column: Collection ID
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    session-state: 
      data-type: VARCHAR2

    export-/-printing: 
      include-in-export-/-print: false

    enable-users-to: 
      sort: false

- # ====== Region: Payment Empty Header ========================
  id: 42958205511722541
  identification: 
    name: Payment Empty Header
    type: Static Content

  source: 
    html-code: '<h3 style="visibility: hidden;color:white;font-size:1.125rem;">Payment</h3>'

  layout: 
    sequence: 70
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: 2
    new-column: true
    column-span: 5

  appearance: 
    template: None
    render-components: Above Content

  advanced: 
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Buttons =====================================
  id: 58726409560579468
  identification: 
    name: Buttons
    type: Static Content

  layout: 
    sequence: 120
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    row-css-classes: 
    - buttons-row
    column: 2
    new-column: true
    column-span: 10

  appearance: 
    template: None
    render-components: Above Content

  advanced: 
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: DBA & Date ==================================
  id: 58726513780579469
  identification: 
    name: DBA & Date
    type: Static Content

  layout: 
    sequence: 50
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: 2
    new-column: true
    column-span: 5

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--noUI
    - t-Region--scrollBody
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: dba-and-date
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Invoice List ================================
  id: 58727605027579480
  identification: 
    name: Invoice List
    type: Interactive Grid

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      SELECT 
      NPT001.date_created AS Invoice_Date,
      NPT001.invoice_id AS Invoice_No,
      NPT001.total_amount AS Amount_Paid
      FROM NPT001
      JOIN NPT038 ON NPT038.INVOICE_ID = NPT001.INVOICE_ID
      WHERE NPT038.COLLECTION_ID = :P150_SELECTED_COLLECTION_ID
      AND NPT001.CUSTOMER_ID = :P150_SELECTED_CUSTOMER_ID
    page-items-to-submit: 
    - P150_SELECTED_COLLECTION_ID
    - P150_SELECTED_CUSTOMER_ID

  layout: 
    sequence: 110
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: 8
    new-column: true
    column-span: 4

  appearance: 
    template: Interactive Report
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: invoice-list
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    id: 58727696135579481
    edit: 
      enabled: false

    performance: 
      lazy-loading: false

    appearance: 
      select-first-row: true
      fixed-row-height: true

    pagination: 
      type: Scroll
      show-total-count: false

    toolbar: 
      show: false

    enable-users-to: 
      save-public-report: false
      flashback: false
      define-chart-view: false
      download: false

    heading: 
      fixed-to: Region
      fixed-report-height: 400

    icon-view: 
      show: false

    detail-view: 
      show: false

    advanced: 
      initialization-javascript-function: |
        function( options ) {
            options.defaultModelOptions = {
                pageSize: 1000
            };
            options.defaultGridViewOptions = {
                pagination: {
                    scroll: true,
                    virtual: true,
                    loadMore: false
                },
                resizeColumns: false,
                reorderColumns: false,
                footer: false
            };
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            }
            return options;
        }

    saved-reports: 
    - # ====== Saved Report: Primary Report ========================
      id: 63479396619166922
      identification: 
        name: Primary Report
        alias: 150998

  columns: 
  - # ====== Column: INVOICE_DATE ================================
    id: 19847467544977038
    identification: 
      column-name: INVOICE_DATE
      type: Text Field

    heading: 
      heading: Invoice Date
      alignment: start

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 10
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: INVOICE_DATE
      data-type: DATE
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: INVOICE_NO ==================================
    id: 19847534790977039
    identification: 
      column-name: INVOICE_NO
      type: Text Field

    heading: 
      heading: Invoice No
      alignment: start

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 20
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: true

    source: 
      type: Database Column
      database-column: INVOICE_NO
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

  - # ====== Column: AMOUNT_PAID =================================
    id: 19847610377977040
    identification: 
      column-name: AMOUNT_PAID
      type: Text Field

    heading: 
      heading: Amount Paid
      alignment: start

    settings: 
      trim-spaces: Leading and Trailing
      text-case: NO CHANGE

    layout: 
      sequence: 30
      column-alignment: start
      stretch: Use Report Setting

    accessibility: 
      value-identifies-row: false

    validation: 
      value-required: false

    source: 
      type: Database Column
      database-column: AMOUNT_PAID
      data-type: NUMBER
      query-only: false
      primary-key: false

    default: 
      duplicate-copies-existing-value: true

    column-filter: 
      enabled: false

    export-/-printing: 
      include-in-export-/-print: true

    enable-users-to: 
      sort: false
      hide: false

    advanced: 
      column-initialization-javascript-function: |
        function( options ) {
            options.defaultGridColumnOptions = {
                noHeaderActivate: true
            };
            return options;
        }

- # ====== Region: Invoice List Header =========================
  id: 58728472950579489
  identification: 
    name: Invoice List Header
    type: Static Content

  source: 
    html-code: '<h3 style="color:white;font-size:1.125rem;">Invoice List</h3>'

  layout: 
    sequence: 100
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: 8
    new-column: true
    column-span: 4

  appearance: 
    template: None
    render-components: Above Content

  advanced: 
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

page-items: 
- # ====== Page Item: P150_TOTAL_PAYMENT =======================
  id: 19847827011977042
  identification: 
    name: P150_TOTAL_PAYMENT
    type: Display Only

  label: 
    label: 'Total Payment Received:'
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 10
    region: Summary # 19847714298977041
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: 6

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    format-mask: 999G999G999G999G990D00

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: 0.00

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_TOTAL_CREDIT_MEMO ===================
  id: 19847963950977043
  identification: 
    name: P150_TOTAL_CREDIT_MEMO
    type: Display Only

  label: 
    label: 'Total Credit Memo Used:'
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 20
    region: Summary # 19847714298977041
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: 6

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    format-mask: 999G999G999G999G990D00

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: 0.00

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_SYSDATE =============================
  id: 42955677676722515
  identification: 
    name: P150_SYSDATE
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 20
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: SYSDATE

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_SELECTED_COLLECTION_ID ==============
  id: 42955934410722518
  identification: 
    name: P150_SELECTED_COLLECTION_ID
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 30
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_SELECTED_CUSTOMER_ID ================
  id: 42956065964722519
  identification: 
    name: P150_SELECTED_CUSTOMER_ID
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 40
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_DBA =================================
  id: 58727245135579473
  identification: 
    name: P150_DBA
    type: Text Field

  label: 
    label: 'DBA<span style="color:red;">*</span>: '
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 10
    region: DBA & Date # 58726513780579469
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 7
    label-column-span: 1

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_DATE_FROM ===========================
  id: 58727333736579474
  identification: 
    name: P150_DATE_FROM
    type: Text Field

  label: 
    label: 'Date<span style="color:red;">*</span>:  '
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 10
    region: DBA & Date # 58726513780579469
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 5
    label-column-span: 1

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    width: 30

  validation: 
    value-required: false
    maximum-length: 10

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P150_DATE_TO =============================
  id: 58727492050579475
  identification: 
    name: P150_DATE_TO
    type: Text Field

  label: 
    label: To
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 10
    region: DBA & Date # 58726513780579469
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 5
    label-column-span: 1

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    width: 30

  validation: 
    value-required: false
    maximum-length: 10

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: Change_Customer_DBA =========================
  id: 33414195759636867
  identification: 
    button-name: Change_Customer_DBA
    label: <u>C</u> - Change Customer DBA

  layout: 
    sequence: 10
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: false

  advanced: 
    static-id: c

- # ====== Button: Change_Date =================================
  id: 33414589668636867
  identification: 
    button-name: Change_Date
    label: <u>D</u> - Change Date

  layout: 
    sequence: 20
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: d

- # ====== Button: Print =======================================
  id: 33414936203636867
  identification: 
    button-name: Print
    label: <u>P</u> - Print

  layout: 
    sequence: 40
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: print

- # ====== Button: Export ======================================
  id: 33415379272636868
  identification: 
    button-name: Export
    label: <u>H</u> - Export

  layout: 
    sequence: 50
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: export

- # ====== Button: Escape ======================================
  id: 33416973736636870
  identification: 
    button-name: Escape
    label: '-'

  layout: 
    sequence: 70
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: Automatic
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - hiddenbtn

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:306:&SESSION.::&DEBUG.:::'
      page: 306 # Collection and Outstanding

    warn-on-unsaved-changes: Do Not Check

  advanced: 
    static-id: esc

- # ====== Button: Enter =======================================
  id: 42954532750722504
  identification: 
    button-name: Enter
    label: Enter

  layout: 
    sequence: 60
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - hiddenbtn

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: refresh

- # ====== Button: Navigation ==================================
  id: 42958664468722545
  identification: 
    button-name: Navigation
    label: <u>N</u> - Navigation

  layout: 
    sequence: 30
    region: Buttons # 58726409560579468
    slot: BODY
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    css-classes: 
    - btns
    - text-left

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: navigate

dynamic-actions: 
- # ====== Dynamic Action: Refresh Tables ======================
  id: 33423843382636884
  identification: 
    name: Refresh Tables

  execution: 
    sequence: 20
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P150_DATE_TO

  configuration: 
    build-option: Commented Out # 4207224469083906

  actions: 
  - # ====== Action: Refresh =====================================
    id: 33424889699636885
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Customer Payment # 41787619939876147

    execution: 
      sequence: 20
      event: Refresh Tables # 33423843382636884
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Lose Focus ==========================
  id: 33426170615636887
  identification: 
    name: Lose Focus

  execution: 
    sequence: 40
    event-scope: Static
    type: Immediate

  when: 
    event: Lose Focus
    selection-type: Item(s)
    item(s): 
    - P150_DBA

  actions: 
  - # ====== Action: Refresh =====================================
    id: 33427175657636887
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Customer Payment # 41787619939876147

    execution: 
      sequence: 40
      event: Lose Focus # 33426170615636887
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute JavaScript Code =====================
    id: 42955300119722512
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: mapP150KeysMenu();

    execution: 
      sequence: 10
      event: Lose Focus # 33426170615636887
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Set Value ===================================
    id: 45404628486371507
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_paid NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_paid
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) NOT LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_paid, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_PAYMENT

    execution: 
      sequence: 50
      event: Lose Focus # 33426170615636887
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P150_DATE_FROM

  - # ====== Action: Set Value ===================================
    id: 45404751789371508
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_credit NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_credit
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_credit, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_CREDIT_MEMO

    execution: 
      sequence: 60
      event: Lose Focus # 33426170615636887
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P150_DATE_FROM

  - # ====== Action: Execute JavaScript Code =====================
    id: 45404839257371509
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let field1 = $v("P150_DBA");
        
        if (!field1) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DBA",
                message: "Field cannot be empty."
            });
            $("#P150_DBA").addClass("error-highlight");
            hasError = true;
        } else {
            apex.message.clearErrors("P150_DBA");
        }

    execution: 
      sequence: 20
      event: Lose Focus # 33426170615636887
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Focus on DBA ========================
  id: 33428096881636890
  identification: 
    name: Focus on DBA

  execution: 
    sequence: 50
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Change_Customer_DBA # 33414195759636867

  actions: 
  - # ====== Action: Set Focus ===================================
    id: 33428580018636890
    identification: 
      action: Set Focus

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_DBA

    execution: 
      sequence: 10
      event: Focus on DBA # 33428096881636890
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Focus on Date =======================
  id: 33428954822636892
  identification: 
    name: Focus on Date

  execution: 
    sequence: 60
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Change_Date # 33414589668636867

  actions: 
  - # ====== Action: Set Focus ===================================
    id: 33429401470636892
    identification: 
      action: Set Focus

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_DATE_FROM

    execution: 
      sequence: 10
      event: Focus on Date # 33428954822636892
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Click Enter =========================
  id: 42954642430722505
  identification: 
    name: Click Enter

  execution: 
    sequence: 90
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Enter # 42954532750722504

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 42956307454722522
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        apex.message.clearErrors();
        
        let field1 = $v("P150_DBA");
        let field2 = $v("P150_DATE_FROM");
        let field3 = $v("P150_DATE_TO");
        
        let hasError = false;
        
        
        if (!field1) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DBA",
                message: "Field cannot be empty."
            });
            $("#P150_DBA").addClass("error-highlight");
            hasError = true;
        }
        
        
        if (!field2) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_FROM",
                message: "Field cannot be empty."
            });
            $("#P150_DATE_FROM").addClass("error-highlight");
            hasError = true;
        } else if (!isValidDate(field2)) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_FROM",
                message: "Invalid date format."
            });
            $("#P150_DATE_FROM").addClass("error-highlight");
            hasError = true;
        }
        
        
        if (!field3) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_TO",
                message: "Field cannot be empty."
            });
            $("#P150_DATE_TO").addClass("error-highlight");
            hasError = true;
        } else if (!isValidDate(field3)) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_TO",
                message: "Invalid date format."
            });
            $("#P150_DATE_TO").addClass("error-highlight");
            hasError = true;
        }
        
        
        if (hasError){
            apex.da.cancel();
        }

    execution: 
      sequence: 10
      event: Click Enter # 42954642430722505
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Set Value ===================================
    id: 42957219709722531
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_paid NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_paid
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) NOT LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_paid, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_PAYMENT

    execution: 
      sequence: 50
      event: Click Enter # 42954642430722505
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Set Value ===================================
    id: 42957760702722536
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_credit NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_credit
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_credit, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_CREDIT_MEMO

    execution: 
      sequence: 60
      event: Click Enter # 42954642430722505
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Refresh =====================================
    id: 45405930702371520
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Customer Payment # 41787619939876147

    execution: 
      sequence: 20
      event: Click Enter # 42954642430722505
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute JavaScript Code =====================
    id: 45406506979371526
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        const interval = setInterval(() => {
            if ($("#payment_ig_grid_vc .a-GV-cell").length > 0) {
                clearInterval(interval);
                $("#payment_ig_grid_vc .a-GV-cell").first().trigger("click");
        
        
                const waitForValue = setInterval(() => {
                    if ($v("P150_SELECTED_COLLECTION_ID")) { 
                        clearInterval(waitForValue); 
                        apex.region("invoice-list").refresh(); 
                    }
                }, 100); 
            }
        }, 100); 
        

    execution: 
      sequence: 70
      event: Click Enter # 42954642430722505
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Get Focus ===========================
  id: 42954939448722508
  identification: 
    name: Get Focus

  execution: 
    sequence: 30
    event-scope: Static
    type: Immediate

  when: 
    event: Get Focus
    selection-type: Item(s)
    item(s): 
    - P150_DBA

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 42955061406722509
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        $(document).off('keydown.p150keyevents');
        
        $(".ui-dialog-datepicker").css("display", "none");

    execution: 
      sequence: 10
      event: Get Focus # 42954939448722508
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Selection Change ====================
  id: 42956108715722520
  identification: 
    name: Selection Change

  execution: 
    sequence: 100
    event-scope: Static
    type: Immediate

  when: 
    event: NATIVE_IG|REGION TYPE|interactivegridselectionchange
    selection-type: Region
    region: Customer Payment # 41787619939876147

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 42956226289722521
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let selectedRecords = this.data.selectedRecords;
        
        
        if (selectedRecords.length > 0) {
        
            let collectionIDSelected = selectedRecords[0][6];
            let customerIDSelected = selectedRecords[0][5];
        
            $("#P150_SELECTED_COLLECTION_ID").val(collectionIDSelected);
            $("#P150_SELECTED_CUSTOMER_ID").val(customerIDSelected);
        
            console.log("Collection: " + collectionIDSelected);
            console.log("Customer: " + customerIDSelected);
        
        } 
        

    execution: 
      sequence: 10
      event: Selection Change # 42956108715722520
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Refresh =====================================
    id: 42956411888722523
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Invoice List # 58727605027579480

    execution: 
      sequence: 50
      event: Selection Change # 42956108715722520
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute JavaScript Code =====================
    id: 42958949820722548
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |2
            let grid = apex.region("invoice-list").widget().interactiveGrid("getViews", "grid");
            let totalRows = grid.model.getTotalRecords(); 
            let displayedRows = grid.model._data.length; 
        
            let button = $("#navigate");
        
            if (totalRows > displayedRows) {
                $("#navigate").removeClass("apex_disabled");
                $("#navigate").attr("disabled", false);
            } else {
                $("#navigate").addClass("apex_disabled");
                $("#navigate").attr("disabled", true); 
            }

    execution: 
      sequence: 40
      event: Selection Change # 42956108715722520
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Change ==============================
  id: 42957343775722532
  identification: 
    name: Change

  execution: 
    sequence: 110
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P150_DATE_FROM

  configuration: 
    build-option: Commented Out # 4207224469083906

  actions: 
  - # ====== Action: Refresh =====================================
    id: 42957615754722535
    identification: 
      action: Refresh

    affected-elements: 
      selection-type: Region
      region: Customer Payment # 41787619939876147

    execution: 
      sequence: 10
      event: Change # 42957343775722532
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Set Value ===================================
    id: 45404443200371505
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_paid NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_paid
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) NOT LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_paid, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_PAYMENT

    execution: 
      sequence: 20
      event: Change # 42957343775722532
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P150_DBA

  - # ====== Action: Set Value ===================================
    id: 45404589968371506
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_total_credit NUMBER := 0;
        BEGIN
            SELECT 
                SUM(NPT005.amount)
            INTO
                v_total_credit
            FROM
                NPT005
            JOIN 
                NPT038 ON NPT005.collection_id = NPT038.collection_id
            JOIN
                NPT001 ON NPT038.invoice_id = NPT001.invoice_id
            JOIN 
                NPT009 ON NPT001.customer_id = NPT009.customer_id
            WHERE
                UPPER(NPT009.DBA) = UPPER(:P150_DBA)
            AND
                TRUNC(NPT005.DATE_CREATED) BETWEEN :P150_DATE_FROM AND :P150_DATE_TO
            AND
                UPPER(NPT005.CASHCHECK) LIKE '%CMEMO%';
        
            RETURN NVL(TO_CHAR(v_total_credit, 'FM999990.00'), '0.00');
        
        EXCEPTION
            WHEN OTHERS THEN
                RETURN '0.00';
        
        END;
      items-to-submit: 
      - P150_DBA
      - P150_DATE_FROM
      - P150_DATE_TO
      escape-special-characters: true
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P150_TOTAL_CREDIT_MEMO

    execution: 
      sequence: 40
      event: Change # 42957343775722532
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item is not null
      item: P150_DBA

- # ====== Dynamic Action: Click Print =========================
  id: 42957835258722537
  identification: 
    name: Click Print

  execution: 
    sequence: 120
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Print # 33414936203636867

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 42957981632722538
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().slice(0, 10).replace(/-/g, "");
        
        generateReport("PAYMENTS_MAP_PDF_COURIER_NEW", "pdf", { 
            fileName: `PaymentsMap_${formattedDate}.pdf`,
            mode : "print",
            parameters : {
                P_DBA : $v("P150_DBA"),
                P_DATE_FROM : $v("P150_DATE_FROM"),
                P_DATE_TO : $v("P150_DATE_TO")
            },
            spinnerEnabled : true
        });

    execution: 
      sequence: 10
      event: Click Print # 42957835258722537
      fire-when-event-result-is: True
      fire-on-initialization: false

    configuration: 
      build-option: Commented Out # 4207224469083906

- # ====== Dynamic Action: Click Export ========================
  id: 42958085211722539
  identification: 
    name: Click Export

  execution: 
    sequence: 130
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Export # 33415379272636868

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 42958123345722540
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        const currentDate = new Date();
        const formattedDate = currentDate.toISOString().slice(0, 10).replace(/-/g, "");
        
        generateReport("PAYMENTS_MAP_XLSX", "xlsx", { 
            fileName: `PaymentsMap_${formattedDate}.xlsx`,
            mode : "print",
            parameters : {
                P_DBA : $v("P150_DBA"),
                P_DATE_FROM : $v("P150_DATE_FROM"),
                P_DATE_TO : $v("P150_DATE_TO")
            },
            spinnerEnabled : true
        });

    execution: 
      sequence: 10
      event: Click Export # 42958085211722539
      fire-when-event-result-is: True
      fire-on-initialization: false

    configuration: 
      build-option: Commented Out # 4207224469083906

- # ====== Dynamic Action: Page load button ====================
  id: 45404053412371501
  identification: 
    name: Page load button

  execution: 
    sequence: 140
    event-scope: Static

  when: 
    event: Page Load

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 45404103837371502
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        $("#navigate").addClass("apex_disabled");
        $("#navigate").attr("disabled", true);
        
        

    execution: 
      sequence: 10
      event: Page load button # 45404053412371501
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Lose Focus FROM =====================
  id: 45404921576371510
  identification: 
    name: Lose Focus FROM

  execution: 
    sequence: 150
    event-scope: Static
    type: Immediate

  when: 
    event: Lose Focus
    selection-type: Item(s)
    item(s): 
    - P150_DATE_FROM

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 45405147247371512
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let field2 = $v("P150_DATE_FROM");
        
        
        if (!field2) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_FROM",
                message: "Field cannot be empty."
            });
            $("#P150_DATE_FROM").addClass("error-highlight");
            hasError = true;
        } else if (!isValidDate(field2)) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_FROM",
                message: "Invalid date format. Use MM/DD/YYYY."
            });
            $("#P150_DATE_FROM").addClass("error-highlight");
            hasError = true;
        } else {
            apex.message.clearErrors("P150_DATE_FROM");
        }

    execution: 
      sequence: 10
      event: Lose Focus FROM # 45404921576371510
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Lose Focus TO =======================
  id: 45405255019371513
  identification: 
    name: Lose Focus TO

  execution: 
    sequence: 160
    event-scope: Static
    type: Immediate

  when: 
    event: Lose Focus
    selection-type: Item(s)
    item(s): 
    - P150_DATE_TO

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 45405423837371515
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let field3 = $v("P150_DATE_TO");
        
        if (!field3) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_TO",
                message: "Field cannot be empty."
            });
            $("#P150_DATE_TO").addClass("error-highlight");
            hasError = true;
        } else if (!isValidDate(field3)) {
            apex.message.showErrors({
                type: "error",
                location: "inline",
                pageItem: "P150_DATE_TO",
                message: "Invalid date format. Use MM/DD/YYYY."
            });
            $("#P150_DATE_TO").addClass("error-highlight");
            hasError = true;
        } else {
            apex.message.clearErrors("P150_DATE_TO");
        }

    execution: 
      sequence: 10
      event: Lose Focus TO # 45405255019371513
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Navigate Click ======================
  id: 45405750592371518
  identification: 
    name: Navigate Click

  execution: 
    sequence: 170
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Navigation # 42958664468722545

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 45405854722371519
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var isPaymentSelected = $("#payment_ig_grid_vc .a-GV-bdy").find(".is-focused").length;
        console.log(isPaymentSelected)
        if(isPaymentSelected >= 1) {
            $("#invoice-list_ig_grid_vc .a-GV-bdy .a-GV-cell").first().trigger("click");
        } else {
            $("#payment_ig_grid_vc .a-GV-bdy .a-GV-cell").first().trigger("click");
        }

    execution: 
      sequence: 10
      event: Navigate Click # 45405750592371518
      fire-when-event-result-is: True
      fire-on-initialization: false

processes: 
- # ====== Process: Clear Session ==============================
  id: 42956506581722524
  identification: 
    name: Clear Session
    type: Clear Session State
    execution-chain: None

  settings: 
    type: Clear all Items on the Current Page

  execution: 
    sequence: 10
    point: Before Header
    run-process: Once Per Page Visit (default)

