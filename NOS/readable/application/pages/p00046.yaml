---
# ====== Page: Add/Update Purchase Order =====================
id: 46
identification: 
  name: Add/Update Purchase Order
  alias: ADD-UPDATE-PURCHASE-ORDER
  title: Add/Update Purchase Order

appearance: 
  page-mode: Normal
  page-template: Standard - No Footer
  template-options: 
  - '#DEFAULT#'

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: First item on page
  warn-on-unsaved-changes: true

javascript: 
  file-urls: 
  - '#APP_FILES#js/cmn#MIN#.js'
  function-and-global-variable-declaration: |
    const p8KeyMap = {
        escape: (v) => {
            if($("#add-notes").is(":visible")) {
                $("#close").trigger("click");
            } else if($("#add-notes-two").is(":visible")) {
                $("#close-two").trigger("click");
            } else {
                $("#exit").trigger("click");
            }
        }
    }
    
    function mapP8Keys() {
        $(document).off('keydown.p8keyevents');
        $(document).on('keydown.p8keyevents', (ev) => {
            var key = ev.key?.toLowerCase();
            if (p8KeyMap[key]) {
                ev.preventDefault();
                p8KeyMap[key]();
            }
        });
    }
  execute-when-page-loads: |
    mapP8Keys();
    
    $(document).ready(function() {
        $("#P46_CLOSING_EMAIL_DETAIL").on("keydown", function(event) {
            if($v("P46_PROCESS") === 'A') {
                if($("#add-notes-two").is(":visible")) {
                    if (event.key === "Enter" || event.keyCode === 13) {
                        $.event.trigger('addnotestwo');
                        event.preventDefault();
                    }
                }
            }
        });
    
        $(document).on("keydown", function(event) {
            if (event.key === "Enter" || event.keyCode === 13) {
                if(!$("#add-notes").is(":visible") && !$("#add-notes-two").is(":visible")) {
                    if($v("P46_FROM") === "C" || $v("P46_FROM") === "U") {
                        $.event.trigger('RedirectToLineItems');
                    } else if ($v("P46_FROM") === "A" || $v("P46_FROM") === "R") {
                        if($v("P46_LAST_ITEM") === "Y") {
                            $.event.trigger('RedirectToLineItems');
                        }
                    }
                } else {
                    if($v("P46_PROCESS") === 'U') {
                        if($("#add-notes").is(":visible")) {
                            $.event.trigger('updatenotes');
                        } else if($("#add-notes-two").is(":visible")) {
                            $.event.trigger('addnotestwo');
                        }
                        event.preventDefault();
                    }
                }
            }
        });
    
        $(document).on("keydown", function(event) {
            if(event.key === "F7") {
                if($("#add-notes").is(":visible")) {
                    $.event.trigger('addnotes');
                    event.preventDefault();
                } else if($("#add-notes-two").is(":visible")) {
                    event.preventDefault();
                } else {
                    $("#notes").trigger("click");
                    event.preventDefault();
                }
            }
        });
    });
    
    var fromValue = $v("P46_FROM");
    
    setTitle(`${fromValue === "A" ? "Add Purchase Order" :
                fromValue === "U" ? "Update Purchase Order" :
                fromValue === "C" ? "Create Child PO" :
                "Add New PO using an Existing PO"}`);

css: 
  inline: |
    .t-Header .t-Header-branding {
        background-color: white !important;
        color: rgb(30, 58, 138) !important;
    }
    
    body {
        background-color: rgb(30, 58, 138);
    }
    
    div.container:first-of-type {
        padding: 1rem 2rem 2rem 2rem !important;
        margin: 0 !important;
    }
    
    .form-container label,
    .form-container input,
    .t-Region-title {
        font-size: 1.125rem;
    }
    
    .t-Form-labelContainer {
        display: flex;
        justify-content: space-between;
        align-items: start;
    }
    
    .t-Form-labelContainer .t-Form-label::before {
        content: "" !important;
    }
    
    .t-Region-body {
        padding: .5rem 2rem .5rem 1rem !important;
        border: var(--ut-region-border-color,var(--ut-component-border-color));
        border-radius: 0.5rem;
        border-style: solid;
        border-width: var(--ut-region-border-width,var(--ut-component-border-width,1px));
    }
    
    .hide {
        display: none;
    }
    
    .t-Region-header {
        background-color: rgb(30, 58, 138);
        color: white;
    }
    
    .btns {
        font-size: 1.125rem;
        color: white;
    }
    
    .text-left {
        text-align: left;
    }
    
    .text-right {
        text-align: right;
    }
    
    .t-margin {
        margin-top: 3.5rem;
    }
    
    .ui-dialog-titlebar {
        display: none !important;
    }
    
    .ui-dialog {
        background-color: #056AC8;
        color: white;
        width: 70rem !important;
        height: auto !important;
    }
    
    #add-notes .container,
    #add-notes-two .container {
        padding-left: 2rem;
    }
    
    #add-notes label,
    #add-notes-two label {
        color: white;
        font-size: 1.125rem;
    }
    
    .t-DialogRegion-bodyWrapperOut {
        overflow: hidden !important;
    }
    
    #P46_ACCOUNT_NO_LABEL.t-Form-label::after,
    #P46_REMARKS_LABEL.t-Form-label::after,
    #P46_NOTE_LABEL.t-Form-label::after,
    #P46_SUBJECT_LABEL.t-Form-label::after,
    #P46_OPENING_EMAIL_LABEL.t-Form-label::after,
    #P46_CLOSING_EMAIL_LABEL.t-Form-label::after {
        content: " *" !important;
        color: red;
    }
    
    #add-notes .t-Form-error,
    #add-notes-two .t-Form-error {
        color: #FFD700 !important;
        margin-bottom: 0;
    }
    
    #add-notes .t-Form-inputContainer,
    #add-notes-two .t-Form-inputContainer {
        padding-block-end: var(--ut-field-padding-y, 0) !important;
    }
    
    .r-margin {
        margin-right: 1rem;
    }
    
    .a-PopupLOV-results {
        color: black;
        background-color: white;
    }
    
    .ui-dialog.ui-front {
        z-index: 1000 !important;
    }

security: 
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

regions: 
- # ====== Region: Vendor Info - A =============================
  id: 11738085220394646
  identification: 
    name: Vendor Info - A
    type: Static Content

  layout: 
    sequence: 70
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--scrollBody
    - margin-top-none
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: A

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Vessel Information ==========================
  id: 11738457717394650
  identification: 
    name: Vessel Information
    type: Static Content

  layout: 
    sequence: 120
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--noBorder
    - t-Region--scrollBody
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Cost Information ============================
  id: 16245118495344104
  identification: 
    name: Cost Information
    type: Static Content

  layout: 
    sequence: 130
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--noBorder
    - t-Region--scrollBody
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Vendor Info - C =============================
  id: 24534290785263040
  identification: 
    name: Vendor Info - C
    type: Static Content

  layout: 
    sequence: 80
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--scrollBody
    - margin-top-none
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: C

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Vendor Info - U =============================
  id: 24649241343650404
  identification: 
    name: Vendor Info - U
    type: Static Content

  layout: 
    sequence: 110
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--scrollBody
    - margin-top-none
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: U

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Vendor Info - R =============================
  id: 24650126430650413
  identification: 
    name: Vendor Info - R
    type: Static Content

  layout: 
    sequence: 90
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - form-container

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--removeHeader js-removeLandmark
    - t-Region--scrollBody
    - margin-top-none
    - margin-bottom-none
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: R

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Add Notes ===================================
  id: 33626330564196829
  identification: 
    name: Add Notes
    type: Static Content

  layout: 
    sequence: 30
    parent-region: No Parent
    slot: REGION_POSITION_04
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Inline Dialog
    template-options: 
    - '#DEFAULT#'
    - t-DialogRegion--noPadding
    - js-dialog-nosize
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: add-notes
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    header-text: '<div style="font-size: 1.5rem; margin: .25rem 0 0 1rem">Add Notes</div>'

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Add Notes - Page 2 ==========================
  id: 37832847550283602
  identification: 
    name: Add Notes - Page 2
    type: Static Content

  layout: 
    sequence: 40
    parent-region: No Parent
    slot: REGION_POSITION_04
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Inline Dialog
    template-options: 
    - '#DEFAULT#'
    - t-DialogRegion--noPadding
    - js-dialog-nosize
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    static-id: add-notes-two
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    header-text: '<div style="font-size: 1.5rem; margin: .25rem 0 0 1rem">Add Notes</div>'

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

page-items: 
- # ====== Page Item: P46_PUR_ORDER_NO =========================
  id: 11738286070394648
  identification: 
    name: P46_PUR_ORDER_NO
    type: Display Only

  label: 
    label: Purchase Order No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 10
    region: Vendor Info - A # 11738085220394646
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VENDOR_NAME ==========================
  id: 11738376414394649
  identification: 
    name: P46_VENDOR_NAME
    type: Popup LOV

  label: 
    label: Vendor Name
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  multiple-values: 
    type: No

  layout: 
    sequence: 20
    region: Vendor Info - A # 11738085220394646
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 6
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--xlarge
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT
          VENDOR_NAME, VENDOR_ID
      FROM
          NIT006
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VESSEL_NAME ==========================
  id: 16244805577344101
  identification: 
    name: P46_VESSEL_NAME
    type: Text Field

  label: 
    label: Vessel Name
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 10
    region: Vessel Information # 11738457717394650
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 6
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ETD ==================================
  id: 16244924274344102
  identification: 
    name: P46_ETD
    type: Text Field

  label: 
    label: ETD
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 20
    region: Vessel Information # 11738457717394650
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 4
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    width: 30
    value-placeholder: MM/DD/YYYY

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ETA ==================================
  id: 16245010401344103
  identification: 
    name: P46_ETA
    type: Text Field

  label: 
    label: ETA
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 40
    region: Vessel Information # 11738457717394650
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 4
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    width: 30
    value-placeholder: MM/DD/YYYY

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_PRICING_TYPE =========================
  id: 16245206127344105
  identification: 
    name: P46_PRICING_TYPE
    type: Popup LOV

  label: 
    label: Pricing Type
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  multiple-values: 
    type: No

  layout: 
    sequence: 10
    region: Cost Information # 16245118495344104
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 5
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--xlarge
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT
          PRICING_TYPE_DESCRIPTION, PRICING_TYPE_ID
      FROM
          NIM032
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ADDED_COST_1 =========================
  id: 16245384828344106
  identification: 
    name: P46_ADDED_COST_1
    type: Select List

  label: 
    label: Added Cost
    alignment: Left

  settings: 
    page-action-on-selection: None

  multiple-values: 
    type: No

  layout: 
    sequence: 20
    region: Cost Information # 16245118495344104
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 3
    label-column-span: 2

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--xlarge
    height: 1

  validation: 
    value-required: false

  list-of-values: 
    type: Static Values
    static-values: 'STATIC:+,x'
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ADDED_COST_2 =========================
  id: 16245433444344107
  identification: 
    name: P46_ADDED_COST_2
    type: Text Field

  label: 
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 30
    region: Cost Information # 16245118495344104
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: true
    column-span: 2
    label-column-span: 0

  appearance: 
    template: Required 2
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Ignore

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_PO_ID ================================
  id: 16245555501344108
  identification: 
    name: P46_PO_ID
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 10
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_LAST_ITEM ============================
  id: 20869173901453215
  identification: 
    name: P46_LAST_ITEM
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 20
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_URL ==================================
  id: 20871112235453235
  identification: 
    name: P46_URL
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 30
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_FROM =================================
  id: 24533508777263033
  identification: 
    name: P46_FROM
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 40
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_MOTHER_NO ============================
  id: 24534300159263041
  identification: 
    name: P46_MOTHER_NO
    type: Display Only

  label: 
    label: Mother PO No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 10
    region: Vendor Info - C # 24534290785263040
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_CHILD_NO =============================
  id: 24534411413263042
  identification: 
    name: P46_CHILD_NO
    type: Display Only

  label: 
    label: Child PO No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 20
    region: Vendor Info - C # 24534290785263040
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VENDOR_NAME_C ========================
  id: 24534519534263043
  identification: 
    name: P46_VENDOR_NAME_C
    type: Display Only

  label: 
    label: Vendor Name
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 30
    region: Vendor Info - C # 24534290785263040
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VENDOR_ID_C ==========================
  id: 24648986571650401
  identification: 
    name: P46_VENDOR_ID_C
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 50
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  server-side-condition: 
    type: Item != Value
    item: P46_FROM
    value: A

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_PUR_ORDER_NO_U =======================
  id: 24649372017650405
  identification: 
    name: P46_PUR_ORDER_NO_U
    type: Display Only

  label: 
    label: Purchase Order No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 10
    region: Vendor Info - U # 24649241343650404
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VENDOR_NAME_U ========================
  id: 24649495278650406
  identification: 
    name: P46_VENDOR_NAME_U
    type: Display Only

  label: 
    label: Vendor Name
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 20
    region: Vendor Info - U # 24649241343650404
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_REFERENCE_PO =========================
  id: 24650287711650414
  identification: 
    name: P46_REFERENCE_PO
    type: Display Only

  label: 
    label: Reference PO No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 10
    region: Vendor Info - R # 24650126430650413
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_PUR_ORDER_NO_R =======================
  id: 24650379354650415
  identification: 
    name: P46_PUR_ORDER_NO_R
    type: Display Only

  label: 
    label: Purchase Order No.
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 20
    region: Vendor Info - R # 24650126430650413
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_VENDOR_NAME_R ========================
  id: 24650446612650416
  identification: 
    name: P46_VENDOR_NAME_R
    type: Display Only

  label: 
    label: Vendor Name
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 30
    region: Vendor Info - R # 24650126430650413
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--normalDisplay

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ACCOUNT_NO ===========================
  id: 33626904763196835
  identification: 
    name: P46_ACCOUNT_NO
    type: Text Field

  label: 
    label: Account No
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 20
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 5
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-top-sm
    - margin-bottom-none
    - margin-right-sm
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_REMARKS ==============================
  id: 33627021604196836
  identification: 
    name: P46_REMARKS
    type: Text Field

  label: 
    label: Remarks
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 30
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-bottom-none
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_NOTE =================================
  id: 33627733142196843
  identification: 
    name: P46_NOTE
    type: Popup LOV

  label: 
    label: Note
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  multiple-values: 
    type: No

  layout: 
    sequence: 40
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT NOTE as d, NOTE_ID as r
      FROM NIM030
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_IMPORTANT ============================
  id: 33627874067196844
  identification: 
    name: P46_IMPORTANT
    type: Text Field

  label: 
    label: Important
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 60
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_SUBJECT ==============================
  id: 33627981762196845
  identification: 
    name: P46_SUBJECT
    type: Textarea

  label: 
    label: Subject
    alignment: Left

  settings: 
    resizable: false
    auto-height: false
    character-counter: false
    trim-spaces: Leading and Trailing

  layout: 
    sequence: 70
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-bottom-sm
    - margin-right-md
    width: 30
    height: 2

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_NOTE_DETAIL ==========================
  id: 33628123176196847
  identification: 
    name: P46_NOTE_DETAIL
    type: Textarea

  label: 
    alignment: Left

  settings: 
    resizable: false
    auto-height: false
    character-counter: false
    trim-spaces: Leading and Trailing

  layout: 
    sequence: 50
    region: Add Notes # 33626330564196829
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-bottom-sm
    - margin-right-md
    width: 30
    height: 5

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_OPENING_EMAIL ========================
  id: 37833026631283604
  identification: 
    name: P46_OPENING_EMAIL
    type: Popup LOV

  label: 
    label: Opening Email
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  multiple-values: 
    type: No

  layout: 
    sequence: 10
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT OPENING_EMAIL as d, OPENING_EMAIL_ID as r
      FROM NIM033
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_OPENING_EMAIL_DETAIL =================
  id: 37833207202283606
  identification: 
    name: P46_OPENING_EMAIL_DETAIL
    type: Textarea

  label: 
    alignment: Left

  settings: 
    resizable: true
    auto-height: false
    character-counter: false
    trim-spaces: Leading and Trailing

  layout: 
    sequence: 30
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-bottom-sm
    - margin-right-md
    width: 30
    height: 5

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_CLOSING_EMAIL ========================
  id: 37833311998283607
  identification: 
    name: P46_CLOSING_EMAIL
    type: Popup LOV

  label: 
    label: Closing Email
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    search-as-you-type: true
    minimum-characters: No minimum (0)

  multiple-values: 
    type: No

  layout: 
    sequence: 60
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT CLOSING_EMAIL as d, CLOSING_EMAIL_ID as r
      FROM NIM034
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_CLOSING_EMAIL_DETAIL =================
  id: 37833497994283608
  identification: 
    name: P46_CLOSING_EMAIL_DETAIL
    type: Textarea

  label: 
    alignment: Left

  settings: 
    resizable: true
    auto-height: false
    character-counter: false
    trim-spaces: Leading and Trailing

  layout: 
    sequence: 70
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 12
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-bottom-md
    - margin-right-md
    width: 30
    height: 5

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_LESS =================================
  id: 37833525392283609
  identification: 
    name: P46_LESS
    type: Text Field

  label: 
    label: Less
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 40
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 8
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_ADD ==================================
  id: 37833678167283610
  identification: 
    name: P46_ADD
    type: Text Field

  label: 
    label: Add
    alignment: Left

  settings: 
    subtype: Text
    trim-spaces: Leading and Trailing
    text-case: NO CHANGE
    submit-when-enter-pressed: false
    disabled: false

  layout: 
    sequence: 50
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 8
    label-column-span: 2

  appearance: 
    template: Optional
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - margin-right-md
    width: 30

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Request (Memory Only)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P46_PROCESS ==============================
  id: 37835295933283626
  identification: 
    name: P46_PROCESS
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 10
    region: Add Notes # 33626330564196829
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Request (Memory Only)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

buttons: 
- # ====== Button: Exit ========================================
  id: 16246192723344114
  identification: 
    button-name: Exit
    label: Exit

  layout: 
    sequence: 140
    region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    column-css-classes: 
    - hide
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Redirect to Page in this Application
    target: 
      url: 'f?p=&APP_ID.:29:&SESSION.::&DEBUG.:::'
      page: 29 # Review Purchase Order

    warn-on-unsaved-changes: Do Not Check

  advanced: 
    static-id: exit

- # ====== Button: ADD_NOTES ===================================
  id: 33626208059196828
  identification: 
    button-name: ADD_NOTES
    label: <u>F7</u> - Add Notes

  layout: 
    sequence: 150
    region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: 3
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    - t-Button--stretch
    css-classes: 
    - btns
    - text-left
    - t-margin

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: notes

  server-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: U

- # ====== Button: Close =======================================
  id: 33626639176196832
  identification: 
    button-name: Close
    label: Close

  layout: 
    sequence: 80
    region: Add Notes # 33626330564196829
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    css-classes: 
    - hide

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: close

- # ====== Button: Next ========================================
  id: 33628235807196848
  identification: 
    button-name: Next
    label: <u>F7</u> - Next

  layout: 
    sequence: 90
    region: Add Notes # 33626330564196829
    slot: BODY
    start-new-layout: false
    start-new-row: true
    row-css-classes: 
    - r-margin
    column: 11
    new-column: true
    column-span: 2
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    - t-Button--noUI
    - t-Button--stretch
    - t-Button--padBottom
    css-classes: 
    - btns
    - text-right

  behavior: 
    action: Submit Page
    execute-validations: true
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

- # ====== Button: Close-Two ===================================
  id: 37833896030283612
  identification: 
    button-name: Close-Two
    label: Close-two

  layout: 
    sequence: 80
    region: Add Notes - Page 2 # 37832847550283602
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    alignment: Left center

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'
    css-classes: 
    - hide

  behavior: 
    action: Defined by Dynamic Action
    execute-validations: true

  advanced: 
    static-id: close-two

dynamic-actions: 
- # ====== Dynamic Action: Get Vendor Code =====================
  id: 20868361769453207
  identification: 
    name: Get Vendor Code

  execution: 
    sequence: 10
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P46_VENDOR_NAME

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 20868461860453208
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
            v_vendor_code VARCHAR2(20);
            v_current_year VARCHAR2(2);
            v_sequence VARCHAR2(3);
            v_prefix VARCHAR2(30);
        BEGIN
            SELECT vendor_code
            INTO v_vendor_code
            FROM NIT006
            WHERE vendor_id = :P46_VENDOR_NAME;
        
            v_current_year := TO_CHAR(SYSDATE, 'YY');
        
            v_prefix := 'SPN-' || v_vendor_code || '-' || v_current_year;
        
            SELECT LPAD(NVL(MAX(TO_NUMBER(SUBSTR(po_id, LENGTH(v_prefix) + 2, 3))), 0) + 1, 3, '0')
            INTO v_sequence
            FROM NIT012
            WHERE SUBSTR(po_id, 1, LENGTH(v_prefix)) = v_prefix;
        
            :P46_PUR_ORDER_NO := v_prefix || '-' || v_sequence;
        END;
      items-to-submit: 
      - P46_VENDOR_NAME
      items-to-return: 
      - P46_PUR_ORDER_NO
      suppress-change-event: false

    execution: 
      sequence: 20
      event: Get Vendor Code # 20868361769453207
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Focused at Last Field ===============
  id: 20869253333453216
  identification: 
    name: Focused at Last Field

  execution: 
    sequence: 20
    event-scope: Static
    type: Immediate

  when: 
    event: Get Focus
    selection-type: Item(s)
    item(s): 
    - P46_ADDED_COST_2

  actions: 
  - # ====== Action: Set Value ===================================
    id: 20869342935453217
    identification: 
      action: Set Value

    settings: 
      set-type: Static Assignment
      value: Y
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_LAST_ITEM

    execution: 
      sequence: 10
      event: Focused at Last Field # 20869253333453216
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Not Focused on Last Field ===========
  id: 20869409341453218
  identification: 
    name: Not Focused on Last Field

  execution: 
    sequence: 30
    event-scope: Static
    type: Immediate

  when: 
    event: Lose Focus
    selection-type: Item(s)
    item(s): 
    - P46_ADDED_COST_2

  actions: 
  - # ====== Action: Set Value ===================================
    id: 20869519214453219
    identification: 
      action: Set Value

    settings: 
      set-type: Static Assignment
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_LAST_ITEM

    execution: 
      sequence: 10
      event: Not Focused on Last Field # 20869409341453218
      fire-when-event-result-is: True
      fire-on-initialization: true
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: To Line Items =======================
  id: 20869967715453223
  identification: 
    name: To Line Items

  execution: 
    sequence: 40
    event-scope: Static
    type: Immediate

  when: 
    event: Custom
    custom-event: RedirectToLineItems
    selection-type: JavaScript Expression
    javascript-expression: document

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 20870050171453224
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        BEGIN
            IF :P46_FROM = 'A' THEN
                INSERT INTO
                NIT012 (PO_ID, VENDOR_ID, IN_PO_VALUE, EX_PO_VALUE, VESSEL_NAME, ETD_DATE, 
                        ETA_DATE, CREATE_USER, CREATE_DATE, PRICING_TYPE_ID, 
                        ADDED_COST_OPERATOR, ADDED_COST_AMOUNT)
                VALUES 
                        (:P46_PUR_ORDER_NO, :P46_VENDOR_NAME, 0, 0, :P46_VESSEL_NAME, 
                         :P46_ETD, :P46_ETA, V('APP_USER'), SYSDATE, :P46_PRICING_TYPE, 
                         :P46_ADDED_COST_1, :P46_ADDED_COST_2);
            :P46_URL := apex_page.get_url(
               p_page   => 18,
               p_items  => 'P18_PO_NO,P18_VENDOR_ID,P18_FROM',
               p_values => :P46_PUR_ORDER_NO || ',' || :P46_VENDOR_NAME || ',' || :P46_FROM
            );
            ELSIF :P46_FROM = 'C' THEN
                INSERT INTO
                NIT012 (PARENT_PO_ID, PO_ID, VENDOR_ID, IN_PO_VALUE, EX_PO_VALUE, VESSEL_NAME, 
                        ETD_DATE, ETA_DATE, CREATE_USER, CREATE_DATE, PRICING_TYPE_ID, 
                        ADDED_COST_OPERATOR, ADDED_COST_AMOUNT)
                VALUES 
                        (:P46_MOTHER_NO, :P46_CHILD_NO, :P46_VENDOR_ID_C, 0, 0, 
                         :P46_VESSEL_NAME, :P46_ETD, :P46_ETA, V('APP_USER'), SYSDATE, 
                         :P46_PRICING_TYPE, :P46_ADDED_COST_1, :P46_ADDED_COST_2);
                INSERT INTO 
                NIT013 (PO_ID, ITEM_ID, QTY, CREATE_USER, CREATE_DATE, VENDOR_PRICE, 
                        INTERNAL_UOM_ID, EXTERNAL_UOM_ID, INTERNAL_PRICE, EXTERNAL_PRICE, VENDOR_ID)
                SELECT 
                        :P46_CHILD_NO, ITEM_ID, QTY, V('APP_USER'), SYSDATE, VENDOR_PRICE, 
                        INTERNAL_UOM_ID, EXTERNAL_UOM_ID, INTERNAL_PRICE, EXTERNAL_PRICE, VENDOR_ID
                FROM 
                        NIT013
                WHERE 
                        PO_ID = :P46_MOTHER_NO;
            :P46_URL := apex_page.get_url(
               p_page   => 18,
               p_items  => 'P18_PO_NO,P18_VENDOR_ID,P18_FROM',
               p_values => :P46_CHILD_NO || ',' || :P46_VENDOR_ID_C || ',' || :P46_FROM
            );
            ELSIF :P46_FROM = 'R' THEN
                INSERT INTO
                NIT012 (REFERENCE_PO_ID, PO_ID, VENDOR_ID, IN_PO_VALUE, EX_PO_VALUE, VESSEL_NAME, 
                        ETD_DATE, ETA_DATE, CREATE_USER, CREATE_DATE, PRICING_TYPE_ID, 
                        ADDED_COST_OPERATOR, ADDED_COST_AMOUNT)
                VALUES 
                        (:P46_REFERENCE_PO, :P46_PUR_ORDER_NO_R, :P46_VENDOR_ID_C, 0, 0,
                         :P46_VESSEL_NAME, :P46_ETD, :P46_ETA, V('APP_USER'), SYSDATE, 
                         :P46_PRICING_TYPE, :P46_ADDED_COST_1, :P46_ADDED_COST_2);
                INSERT INTO 
                NIT013 (PO_ID, ITEM_ID, QTY, CREATE_USER, CREATE_DATE, VENDOR_PRICE, 
                        INTERNAL_UOM_ID, EXTERNAL_UOM_ID, INTERNAL_PRICE, EXTERNAL_PRICE, VENDOR_ID)
                SELECT 
                        :P46_PUR_ORDER_NO_R, ITEM_ID, QTY,V('APP_USER'), SYSDATE,
                        VENDOR_PRICE, INTERNAL_UOM_ID, EXTERNAL_UOM_ID, INTERNAL_PRICE, EXTERNAL_PRICE, VENDOR_ID
                FROM 
                        NIT013
                WHERE 
                        PO_ID = :P46_REFERENCE_PO;
            
            :P46_URL := apex_page.get_url(
               p_page   => 18,
               p_items  => 'P18_PO_NO,P18_VENDOR_ID,P18_FROM',
               p_values => :P46_PUR_ORDER_NO_R || ',' || :P46_VENDOR_ID_C || ',' || :P46_FROM
            );
        
            ELSIF :P46_FROM = 'U' THEN
                UPDATE NIT012
                SET 
                    VESSEL_NAME = :P46_VESSEL_NAME, 
                    ETD_DATE = :P46_ETD, 
                    ETA_DATE = :P46_ETA, 
                    UPDATE_USER = V('APP_USER'), 
                    UPDATE_DATE = SYSDATE, 
                    PRICING_TYPE_ID = :P46_PRICING_TYPE, 
                    ADDED_COST_OPERATOR = :P46_ADDED_COST_1, 
                    ADDED_COST_AMOUNT = :P46_ADDED_COST_2
                WHERE 
                    PO_ID = :P46_PUR_ORDER_NO_U;
            
            :P46_URL := apex_page.get_url(
               p_page   => 18,
               p_items  => 'P18_PO_NO,P18_VENDOR_ID',
               p_values => :P46_PUR_ORDER_NO_U || ',' || :P46_VENDOR_ID_C
            );
        
            END IF;
        END;
        
        
        
        
      items-to-submit: 
      - P46_PUR_ORDER_NO
      - P46_VENDOR_NAME_C
      - P46_VESSEL_NAME
      - P46_ETD
      - P46_ETA
      - P46_PRICING_TYPE
      - P46_ADDED_COST_1
      - P46_ADDED_COST_2
      - P46_CHILD_NO
      - P46_VENDOR_ID_C
      - P46_FROM
      items-to-return: 
      - P46_URL
      suppress-change-event: false

    execution: 
      sequence: 20
      event: To Line Items # 20869967715453223
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Execute JavaScript Code =====================
    id: 20870910157453233
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var vendorName = $v('P46_VENDOR_NAME');
        var vesselName = $v('P46_VESSEL_NAME');
        var etd = $v('P46_ETD');
        var eta = $v('P46_ETA');
        var pricingType = $v('P46_PRICING_TYPE');
        var operator = $v('P46_ADDED_COST_1');
        var amount = $v('P46_ADDED_COST_2');
        var mode = $v('P46_FROM');
        
        apex.message.clearErrors();
        
        var hasErrors = false;
        
        function isDateValid(dateString) {
            var datePattern = /^(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4}$/;
        
            if (!dateString.match(datePattern)) {
                return false;
            }
        
            var parts = dateString.split("/");
            var month = parseInt(parts[0], 10);
            var day = parseInt(parts[1], 10);
            var year = parseInt(parts[2], 10);
        
            var date = new Date(year, month - 1, day);
            return (date.getFullYear() === year && date.getMonth() === (month - 1) && date.getDate() === day);
        }
        
        function isValidAmount(amount) {
            var numberPattern = /^\d{1,6}(\.\d{1,3})?$/;
            var parsedAmount = parseFloat(amount)
            return numberPattern.test(amount) && parsedAmount <= 999.999;
        }
        
        if(mode === "A") {
            if (vendorName == "") {
                apex.message.showErrors([{
                    type: "error",location: ["inline"],
                    pageItem: "P46_VENDOR_NAME",
                    message: "Vendor Name is required",
                    unsafe: false
                }])
                hasErrors = true;
            }
        }
        
        if (vesselName == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_VESSEL_NAME",
                message: "Vessel Name is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (vesselName.length > 50) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_VESSEL_NAME",
                message: "Vessel Name cannot exceed 50 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (etd == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ETD",
                message: "ETD is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (!isDateValid(etd)) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ETD",
                message: "Please Enter a valid date",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (eta == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ETA",
                message: "ETA is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (!isDateValid(eta)) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ETA",
                message: "Please Enter a valid date",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (pricingType == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_PRICING_TYPE",
                message: "Pricing Type is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (operator == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ADDED_COST_1",
                message: "Operator is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (amount == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ADDED_COST_2",
                message: "Amount is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (!isValidAmount(amount)) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ADDED_COST_2",
                message: "Must be a valid amount (Max: 999.999)",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (hasErrors) {
            return false;
        }
        
        apex.message.clearErrors();

    execution: 
      sequence: 10
      event: To Line Items # 20869967715453223
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute JavaScript Code =====================
    id: 20871255272453236
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        let url = $v("P46_URL");
        apex.navigation.redirect(url);
        
        

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_PUR_ORDER_NO

    execution: 
      sequence: 30
      event: To Line Items # 20869967715453223
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Set Child PO Values =================
  id: 24535049624263048
  identification: 
    name: Set Child PO Values

  execution: 
    sequence: 50
    event-scope: Static

  when: 
    event: Page Load

  client-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: C

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 24535124161263049
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
            v_max_suffix CHAR(1);
            v_mother_po_no VARCHAR2(50) := :P46_MOTHER_NO;
            v_next_suffix CHAR(1);
            v_vendor_name VARCHAR(50);
            v_vessel_name VARCHAR(50);
            v_etd VARCHAR(20);
            v_eta VARCHAR(20);
            v_pricing_type_id NUMBER;
            v_cost_operator CHAR(1);
            v_cost_amount NUMBER;
        BEGIN
            SELECT MAX(SUBSTR(po_id, LENGTH(v_mother_po_no) + 1, 1))
            INTO v_max_suffix
            FROM NIT012
            WHERE SUBSTR(po_id, 1, LENGTH(v_mother_po_no)) = v_mother_po_no
            AND REGEXP_LIKE(SUBSTR(po_id, LENGTH(v_mother_po_no) + 1, 1), '^[a-zA-Z]$')
            AND LENGTH(po_id) = LENGTH(v_mother_po_no) + 1;
        
            IF v_max_suffix IS NOT NULL THEN
                v_next_suffix := CHR(ASCII(v_max_suffix) + 1);
            ELSE
                v_next_suffix := 'a';
            END IF;
        
            :P46_CHILD_NO := v_mother_po_no || v_next_suffix;
        
            SELECT VENDOR_NAME
            INTO v_vendor_name
            FROM NIT006
            WHERE VENDOR_ID = :P46_VENDOR_ID_C;
        
            :P46_VENDOR_NAME_C := v_vendor_name;
        
            SELECT VESSEL_NAME, ETD_DATE, ETA_DATE, PRICING_TYPE_ID, ADDED_COST_OPERATOR, ADDED_COST_AMOUNT
            INTO v_vessel_name, v_etd, v_eta, v_pricing_type_id, v_cost_operator, v_cost_amount
            FROM NIT012
            WHERE PO_ID = v_mother_po_no;
        
            :P46_VESSEL_NAME := v_vessel_name;
            :P46_ETD := v_etd;
            :P46_ETA := v_eta;
            :P46_PRICING_TYPE := v_pricing_type_id;
            :P46_ADDED_COST_1 := v_cost_operator;
            :P46_ADDED_COST_2 := v_cost_amount;
        END;
      items-to-submit: 
      - P46_MOTHER_NO
      - P46_VENDOR_ID_C
      items-to-return: 
      - P46_CHILD_NO
      - P46_VENDOR_NAME_C
      - P46_VESSEL_NAME
      - P46_ETD
      - P46_ETA
      - P46_PRICING_TYPE
      - P46_ADDED_COST_1
      - P46_ADDED_COST_2
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Set Child PO Values # 24535049624263048
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Set Update Values ===================
  id: 24649553075650407
  identification: 
    name: Set Update Values

  execution: 
    sequence: 60
    event-scope: Static

  when: 
    event: Page Load

  client-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: U

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 24649693082650408
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
            v_po_no VARCHAR(15) := :P46_PUR_ORDER_NO_U;
            v_vendor_name VARCHAR(50);
            v_vessel_name VARCHAR(50);
            v_etd VARCHAR(20);
            v_eta VARCHAR(20);
            v_pricing_type_id NUMBER;
            v_cost_operator CHAR(1);
            v_cost_amount NUMBER;
        BEGIN
            SELECT VENDOR_NAME
            INTO v_vendor_name
            FROM NIT006
            WHERE VENDOR_ID = :P46_VENDOR_ID_C;
        
            :P46_VENDOR_NAME_U := v_vendor_name;
        
            SELECT VESSEL_NAME, TO_CHAR(ETD_DATE, 'MM/DD/YYYY'), TO_CHAR(ETA_DATE, 'MM/DD/YYYY'), PRICING_TYPE_ID, ADDED_COST_OPERATOR, ADDED_COST_AMOUNT
            INTO v_vessel_name, v_etd, v_eta, v_pricing_type_id, v_cost_operator, v_cost_amount
            FROM NIT012
            WHERE PO_ID = v_po_no;
        
            :P46_VESSEL_NAME := v_vessel_name;
            :P46_ETD := v_etd;
            :P46_ETA := v_eta;
            :P46_PRICING_TYPE := v_pricing_type_id;
            :P46_ADDED_COST_1 := v_cost_operator;
            :P46_ADDED_COST_2 := v_cost_amount;
        END;
      items-to-submit: 
      - P46_VENDOR_ID_C
      - P46_PUR_ORDER_NO_U
      items-to-return: 
      - P46_VENDOR_NAME_U
      - P46_VESSEL_NAME
      - P46_ETD
      - P46_ETA
      - P46_PRICING_TYPE
      - P46_ADDED_COST_1
      - P46_ADDED_COST_2
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Set Update Values # 24649553075650407
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Set Reference PO Values =============
  id: 24650850081650420
  identification: 
    name: Set Reference PO Values

  execution: 
    sequence: 70
    event-scope: Static

  when: 
    event: Page Load

  client-side-condition: 
    type: Item = Value
    item: P46_FROM
    value: R

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 24650980150650421
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
            v_reference_po   VARCHAR2(20) := :P46_REFERENCE_PO;
            v_po_prefix      VARCHAR2(20);
            v_po_suffix      VARCHAR2(5);
            v_next_po_suffix NUMBER;
            v_next_po_no     VARCHAR2(20);
            v_vendor_name    VARCHAR2(50);
            po_exists        NUMBER := 1;
        BEGIN
            v_po_prefix := SUBSTR(v_reference_po, 1, LENGTH(v_reference_po) - 3);
            v_po_suffix := SUBSTR(v_reference_po, -3);
            
            v_next_po_suffix := TO_NUMBER(v_po_suffix) + 1;
            
            WHILE po_exists = 1 LOOP
                v_next_po_no := v_po_prefix || LPAD(v_next_po_suffix, 3, '0');
                
                BEGIN
                    SELECT 1 INTO po_exists
                    FROM NIT012
                    WHERE po_id = v_next_po_no;
                    
                    v_next_po_suffix := v_next_po_suffix + 1;
                EXCEPTION
                    WHEN NO_DATA_FOUND THEN
                        po_exists := 0;
                END;
            END LOOP;
        
            :P46_PUR_ORDER_NO_R := v_next_po_no;
        
            SELECT VENDOR_NAME
            INTO v_vendor_name
            FROM NIT006
            WHERE VENDOR_ID = :P46_VENDOR_ID_C;
        
            :P46_VENDOR_NAME_R := v_vendor_name;
        END;
      items-to-submit: 
      - P46_REFERENCE_PO
      - P46_VENDOR_ID_C
      items-to-return: 
      - P46_PUR_ORDER_NO_R
      - P46_VENDOR_NAME_R
      suppress-change-event: false

    execution: 
      sequence: 10
      event: Set Reference PO Values # 24650850081650420
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Open Add Notes Modal ================
  id: 33626416514196830
  identification: 
    name: Open Add Notes Modal

  execution: 
    sequence: 80
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: ADD_NOTES # 33626208059196828

  actions: 
  - # ====== Action: Open Region =================================
    id: 33626546239196831
    identification: 
      action: Open Region

    affected-elements: 
      selection-type: Region
      region: Add Notes # 33626330564196829

    execution: 
      sequence: 10
      event: Open Add Notes Modal # 33626416514196830
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute Server-side Code ====================
    id: 37835087452283624
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        DECLARE
            l_accNo NIT014.account_no%TYPE;
            l_remarks NIT014.remarks%TYPE;
            l_note NIT014.note_id%TYPE;
            l_noteDetail NIT014.note%TYPE;
            l_important NIT014.important%TYPE;
            l_subject NIT014.subject%TYPE;
            l_opening NIT014.opening_email_id%TYPE;
            l_openingDetail NIT014.opening_email%TYPE;
            l_less NIT014."LESS"%TYPE;
            l_add NIT014."ADD"%TYPE;
            l_close NIT014.closing_email_id%TYPE;
            l_closeDetail NIT014.closing_email%TYPE;
        BEGIN
            SELECT account_no,remarks,note_id,note,important,subject,opening_email_id,opening_email,
                   "LESS","ADD",closing_email_id,closing_email
            INTO l_accNo,l_remarks,l_note,l_noteDetail,l_important,l_subject,l_opening,l_openingDetail,
                   l_less,l_add,l_close,l_closeDetail
            FROM NIT014
            WHERE PO_ID = :P46_PUR_ORDER_NO_U;
        
            :P46_ACCOUNT_NO := l_accNo;
            :P46_REMARKS := l_remarks;
            :P46_NOTE := l_note;
            :P46_NOTE_DETAIL := l_noteDetail;
            :P46_IMPORTANT := l_important;
            :P46_SUBJECT := l_subject;
            :P46_OPENING_EMAIL := l_opening;
            :P46_OPENING_EMAIL_DETAIL := l_openingDetail;
            :P46_LESS := l_less;
            :P46_ADD := l_add;
            :P46_CLOSING_EMAIL := l_close;
            :P46_CLOSING_EMAIL_DETAIL := l_closeDetail;
        
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
            :P46_ACCOUNT_NO := NULL;
            :P46_REMARKS := NULL;
            :P46_NOTE := NULL;
            :P46_NOTE_DETAIL := NULL;
            :P46_IMPORTANT := NULL;
            :P46_SUBJECT := NULL;
            :P46_OPENING_EMAIL := NULL;
            :P46_OPENING_EMAIL_DETAIL := NULL;
            :P46_LESS := NULL;
            :P46_ADD := NULL;
            :P46_CLOSING_EMAIL := NULL;
            :P46_CLOSING_EMAIL_DETAIL := NULL;
        END;
      items-to-submit: 
      - P46_PUR_ORDER_NO_U
      items-to-return: 
      - P46_ACCOUNT_NO
      - P46_REMARKS
      - P46_NOTE
      - P46_NOTE_DETAIL
      - P46_IMPORTANT
      - P46_SUBJECT
      - P46_OPENING_EMAIL
      - P46_OPENING_EMAIL_DETAIL
      - P46_LESS
      - P46_ADD
      - P46_CLOSING_EMAIL
      - P46_CLOSING_EMAIL_DETAIL
      suppress-change-event: false

    execution: 
      sequence: 20
      event: Open Add Notes Modal # 33626416514196830
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Execute JavaScript Code =====================
    id: 37835185003283625
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var accNo = $v("P46_ACCOUNT_NO");
        
        if(accNo === "") {
            apex.item("P46_PROCESS").setValue("A");
        } else {
            apex.item("P46_PROCESS").setValue("U");
        }

    execution: 
      sequence: 30
      event: Open Add Notes Modal # 33626416514196830
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Close Add Notes Modal ===============
  id: 33626753357196833
  identification: 
    name: Close Add Notes Modal

  execution: 
    sequence: 90
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Close # 33626639176196832

  actions: 
  - # ====== Action: Close Region ================================
    id: 33626895231196834
    identification: 
      action: Close Region

    affected-elements: 
      selection-type: Region
      region: Add Notes # 33626330564196829

    execution: 
      sequence: 10
      event: Close Add Notes Modal # 33626753357196833
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Add Notes ===========================
  id: 33627111895196837
  identification: 
    name: Add Notes

  execution: 
    sequence: 100
    event-scope: Static
    type: Immediate

  when: 
    event: Custom
    custom-event: addnotes
    selection-type: JavaScript Expression
    javascript-expression: document

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 33627264228196838
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var accNo = $v('P46_ACCOUNT_NO');
        var remarks = $v('P46_REMARKS');
        var note = $v('P46_NOTE');
        var noteDetail = $v('P46_NOTE_DETAIL');
        var important = $v('P46_IMPORTANT');
        var subject = $v('P46_SUBJECT');
        
        apex.message.clearErrors();
        
        var hasErrors = false;
        
        if (accNo == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ACCOUNT_NO",
                message: "Account No is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (accNo.length > 15) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ACCOUNT_NO",
                message: "Account No must not exceed 15 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (remarks == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_REMARKS",
                message: "Remarks is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (remarks.length > 100) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_REMARKS",
                message: "Remarks must not exceed 100 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (note == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (noteDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (noteDetail.length > 350) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "noteDetail must not exceed 350 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (noteDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (noteDetail.length > 1000) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "noteDetail must not exceed 1000 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (important == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_IMPORTANT",
                message: "Important is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (important.length > 100) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_IMPORTANT",
                message: "Important must not exceed 100 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (subject == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_SUBJECT",
                message: "Subject is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (subject.length > 150) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_SUBJECT",
                message: "Subject must not exceed 150 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (hasErrors) {
            return false;
        }
        
        apex.message.clearErrors();
        
        

    execution: 
      sequence: 10
      event: Add Notes # 33627111895196837
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Close Region ================================
    id: 33627353976196839
    identification: 
      action: Close Region

    affected-elements: 
      selection-type: Region
      region: Add Notes # 33626330564196829

    execution: 
      sequence: 40
      event: Add Notes # 33627111895196837
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Open Region =================================
    id: 37832947467283603
    identification: 
      action: Open Region

    affected-elements: 
      selection-type: Region
      region: Add Notes - Page 2 # 37832847550283602

    execution: 
      sequence: 50
      event: Add Notes # 33627111895196837
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Set Note Details - U ================
  id: 33628339273196849
  identification: 
    name: Set Note Details - U

  execution: 
    sequence: 110
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P46_NOTE

  actions: 
  - # ====== Action: Set Value ===================================
    id: 37836245728283636
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_note_detail VARCHAR2(4000);
        BEGIN
            SELECT CASE
                     WHEN EXISTS (
                         SELECT 1
                         FROM NIT014
                         WHERE PO_ID = :P46_PUR_ORDER_NO_U
                           AND NOTE_ID = :P46_NOTE
                     )
                     THEN
                         (SELECT NOTE
                          FROM NIT014
                          WHERE PO_ID = :P46_PUR_ORDER_NO_U
                            AND NOTE_ID = :P46_NOTE)
                     ELSE
                         (SELECT NOTE
                          FROM NIM030
                          WHERE NOTE_ID = :P46_NOTE)
                   END
            INTO v_note_detail
            FROM DUAL;
        
            RETURN v_note_detail;
        END;
      items-to-submit: 
      - P46_PUR_ORDER_NO_U
      - P46_NOTE
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_NOTE_DETAIL

    execution: 
      sequence: 40
      event: Set Note Details - U # 33628339273196849
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Close Page Two ======================
  id: 37833930090283613
  identification: 
    name: Close Page Two

  execution: 
    sequence: 120
    event-scope: Static
    type: Immediate

  when: 
    event: Click
    selection-type: Button
    button: Close-Two # 37833896030283612

  actions: 
  - # ====== Action: Close Region ================================
    id: 37834066219283614
    identification: 
      action: Close Region

    affected-elements: 
      selection-type: Region
      region: Add Notes - Page 2 # 37832847550283602

    execution: 
      sequence: 10
      event: Close Page Two # 37833930090283613
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Add Notes Two =======================
  id: 37834108757283615
  identification: 
    name: Add Notes Two

  execution: 
    sequence: 130
    event-scope: Static
    type: Immediate

  when: 
    event: Custom
    custom-event: addnotestwo
    selection-type: JavaScript Expression
    javascript-expression: document

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 37834276561283616
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var openingEmail = $v('P46_OPENING_EMAIL');
        var openingEmailDetail = $v('P46_OPENING_EMAIL_DETAIL');
        var less = $v('P46_LESS');
        var add = $v('P46_ADD');
        var closingEmail = $v('P46_CLOSING_EMAIL');
        var closingEmailDetail = $v('P46_CLOSING_EMAIL_DETAIL');
        var process = $v('P46_PROCESS');
        
        apex.message.clearErrors();
        
        var hasErrors = false;
        
        if (openingEmail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_OPENING_EMAIL",
                message: "Opening Email No is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (openingEmailDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_OPENING_EMAIL_DETAIL",
                message: "Opening Email is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (openingEmailDetail.length > 800) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_OPENING_EMAIL_DETAIL",
                message: "Opening Email must not exceed 800 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (less.length > 30) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_LESS",
                message: "Less must not exceed 30 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (add.length > 30) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ADD",
                message: "Add must not exceed 30 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (closingEmail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_CLOSING_EMAIL",
                message: "Closing Email No is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (closingEmailDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_CLOSING_EMAIL_DETAIL",
                message: "Closing Email is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (closingEmailDetail.length > 600) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_CLOSING_EMAIL_DETAIL",
                message: "Closing Email must not exceed 600 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (hasErrors) {
            return false;
        }
        
        apex.message.clearErrors();
        
        

    execution: 
      sequence: 10
      event: Add Notes Two # 37834108757283615
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Execute Server-side Code ====================
    id: 37834911686283623
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        BEGIN
            IF :P46_PROCESS = 'A' THEN 
                INSERT INTO 
                    NIT014 (account_no, remarks, note_id, important, subject, opening_email_id, "LESS", "ADD",
                            closing_email_id, create_user, create_date, update_user, update_date, note, opening_email,
                            closing_email, po_id)
                VALUES 
                    (:P46_ACCOUNT_NO, :P46_REMARKS, :P46_NOTE, :P46_IMPORTANT, :P46_SUBJECT,
                     :P46_OPENING_EMAIL, :P46_LESS, :P46_ADD, :P46_CLOSING_EMAIL, V('APP_USER'), SYSDATE,
                     NULL, NULL, :P46_NOTE_DETAIL, :P46_OPENING_EMAIL_DETAIL, :P46_CLOSING_EMAIL_DETAIL, 
                     :P46_PUR_ORDER_NO_U);
            ELSIF :P46_PROCESS = 'U' THEN
                UPDATE
                    NIT014
                SET
                    account_no = :P46_ACCOUNT_NO,
                    remarks = :P46_REMARKS,
                    note_id = :P46_NOTE,
                    important = :P46_IMPORTANT,
                    subject = :P46_SUBJECT,
                    opening_email_id = :P46_OPENING_EMAIL,
                    "LESS" = :P46_LESS,
                    "ADD" = :P46_ADD,
                    closing_email_id = :P46_CLOSING_EMAIL,
                    update_user = V('APP_USER'),
                    update_date = SYSDATE,
                    note = :P46_NOTE_DETAIL,
                    opening_email = :P46_OPENING_EMAIL_DETAIL,
                    closing_email = :P46_CLOSING_EMAIL_DETAIL
                WHERE po_id = :P46_PUR_ORDER_NO_U;
            END IF;
        END;
        
      items-to-submit: 
      - P46_PUR_ORDER_NO_U
      - P46_PROCESS
      - P46_ACCOUNT_NO
      - P46_REMARKS
      - P46_IMPORTANT
      - P46_NOTE
      - P46_NOTE_DETAIL
      - P46_SUBJECT
      - P46_OPENING_EMAIL
      - P46_OPENING_EMAIL_DETAIL
      - P46_LESS
      - P46_ADD
      - P46_CLOSING_EMAIL
      - P46_CLOSING_EMAIL_DETAIL

    execution: 
      sequence: 20
      event: Add Notes Two # 37834108757283615
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

  - # ====== Action: Close Region ================================
    id: 37835414041283628
    identification: 
      action: Close Region

    affected-elements: 
      selection-type: Region
      region: Add Notes - Page 2 # 37832847550283602

    execution: 
      sequence: 50
      event: Add Notes Two # 37834108757283615
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Set Opening Email Details ===========
  id: 37834398684283617
  identification: 
    name: Set Opening Email Details

  execution: 
    sequence: 140
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P46_OPENING_EMAIL

  actions: 
  - # ====== Action: Set Value ===================================
    id: 37834847928283622
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_opening_email_detail VARCHAR2(4000);
        BEGIN
            SELECT CASE
                     WHEN EXISTS (
                         SELECT 1
                         FROM NIT014
                         WHERE PO_ID = :P46_PUR_ORDER_NO_U
                           AND OPENING_EMAIL_ID = :P46_OPENING_EMAIL
                     )
                     THEN
                         (SELECT OPENING_EMAIL
                          FROM NIT014
                          WHERE PO_ID = :P46_PUR_ORDER_NO_U
                            AND OPENING_EMAIL_ID = :P46_OPENING_EMAIL)
                     ELSE
                         (SELECT OPENING_EMAIL
                          FROM NIM033
                          WHERE OPENING_EMAIL_ID = :P46_OPENING_EMAIL)
                   END
            INTO v_opening_email_detail
            FROM DUAL;
        
            RETURN v_opening_email_detail;
        END;
      items-to-submit: 
      - P46_PUR_ORDER_NO
      - P46_OPENING_EMAIL
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_OPENING_EMAIL_DETAIL

    execution: 
      sequence: 30
      event: Set Opening Email Details # 37834398684283617
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Set Closing Email Details ===========
  id: 37834570602283619
  identification: 
    name: Set Closing Email Details

  execution: 
    sequence: 150
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P46_CLOSING_EMAIL

  actions: 
  - # ====== Action: Set Value ===================================
    id: 37834661991283620
    identification: 
      action: Set Value

    settings: 
      set-type: PL/SQL Function Body
      pl/sql-function-body: |
        DECLARE
            v_closing_email_detail VARCHAR2(4000);
        BEGIN
            SELECT CASE
                     WHEN EXISTS (
                         SELECT 1
                         FROM NIT014
                         WHERE PO_ID = :P46_PUR_ORDER_NO_U
                           AND CLOSING_EMAIL_ID = :P46_CLOSING_EMAIL
                     )
                     THEN
                         (SELECT CLOSING_EMAIL
                          FROM NIT014
                          WHERE PO_ID = :P46_PUR_ORDER_NO_U
                            AND CLOSING_EMAIL_ID = :P46_CLOSING_EMAIL)
                     ELSE
                         (SELECT CLOSING_EMAIL
                          FROM NIM034
                          WHERE CLOSING_EMAIL_ID = :P46_CLOSING_EMAIL)
                   END
            INTO v_closing_email_detail
            FROM DUAL;
        
            RETURN v_closing_email_detail;
        END;
      items-to-submit: 
      - P46_PUR_ORDER_NO
      - P46_CLOSING_EMAIL
      escape-special-characters: false
      suppress-change-event: false

    affected-elements: 
      selection-type: Item(s)
      item(s): 
      - P46_CLOSING_EMAIL_DETAIL

    execution: 
      sequence: 10
      event: Set Closing Email Details # 37834570602283619
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

- # ====== Dynamic Action: Update Notes ========================
  id: 37836855224283642
  identification: 
    name: Update Notes

  execution: 
    sequence: 160
    event-scope: Static
    type: Immediate

  when: 
    event: Custom
    custom-event: updatenotes
    selection-type: JavaScript Expression
    javascript-expression: document

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 37836533560283639
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        UPDATE
            NIT014
        SET
            account_no = :P46_ACCOUNT_NO,
            remarks = :P46_REMARKS,
            note_id = :P46_NOTE,
            important = :P46_IMPORTANT,
            subject = :P46_SUBJECT,
            opening_email_id = :P46_OPENING_EMAIL,
            "LESS" = :P46_LESS,
            "ADD" = :P46_ADD,
            closing_email_id = :P46_CLOSING_EMAIL,
            update_user = V('APP_USER'),
            update_date = SYSDATE,
            note = :P46_NOTE_DETAIL,
            opening_email = :P46_OPENING_EMAIL_DETAIL,
            closing_email = :P46_CLOSING_EMAIL_DETAIL
        WHERE po_id = :P46_PUR_ORDER_NO_U;
        
        
      items-to-submit: 
      - P46_PUR_ORDER_NO_U
      - P46_ACCOUNT_NO
      - P46_REMARKS
      - P46_IMPORTANT
      - P46_NOTE
      - P46_NOTE_DETAIL
      - P46_SUBJECT
      - P46_OPENING_EMAIL
      - P46_OPENING_EMAIL_DETAIL
      - P46_LESS
      - P46_ADD
      - P46_CLOSING_EMAIL
      - P46_CLOSING_EMAIL_DETAIL

    execution: 
      sequence: 20
      event: Update Notes # 37836855224283642
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

    client-side-condition: 
      type: Item = Value
      item: P46_PROCESS
      value: U

  - # ====== Action: Execute JavaScript Code =====================
    id: 37837005020283644
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var accNo = $v('P46_ACCOUNT_NO');
        var remarks = $v('P46_REMARKS');
        var note = $v('P46_NOTE');
        var noteDetail = $v('P46_NOTE_DETAIL');
        var important = $v('P46_IMPORTANT');
        var subject = $v('P46_SUBJECT');
        
        apex.message.clearErrors();
        
        var hasErrors = false;
        
        if (accNo == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ACCOUNT_NO",
                message: "Account No is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (accNo.length > 15) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_ACCOUNT_NO",
                message: "Account No must not exceed 15 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (remarks == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_REMARKS",
                message: "Remarks is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (remarks.length > 100) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_REMARKS",
                message: "Remarks must not exceed 100 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (note == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (noteDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (noteDetail.length > 350) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "noteDetail must not exceed 350 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (noteDetail == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "Note is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (noteDetail.length > 1000) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_NOTE_DETAIL",
                message: "noteDetail must not exceed 1000 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (important == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_IMPORTANT",
                message: "Important is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (important.length > 100) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_IMPORTANT",
                message: "Important must not exceed 100 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (subject == "") {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_SUBJECT",
                message: "Subject is required",
                unsafe: false
            }])
            hasErrors = true;
        } else if (subject.length > 150) {
            apex.message.showErrors([{
                type: "error",location: ["inline"],
                pageItem: "P46_SUBJECT",
                message: "Subject must not exceed 150 characters",
                unsafe: false
            }])
            hasErrors = true;
        }
        
        if (hasErrors) {
            return false;
        }
        
        apex.message.clearErrors();
        
        

    execution: 
      sequence: 10
      event: Update Notes # 37836855224283642
      fire-when-event-result-is: True
      fire-on-initialization: false

  - # ====== Action: Close Region ================================
    id: 37837119593283645
    identification: 
      action: Close Region

    affected-elements: 
      selection-type: Region
      region: Add Notes # 33626330564196829

    execution: 
      sequence: 30
      event: Update Notes # 37836855224283642
      fire-when-event-result-is: True
      fire-on-initialization: false

